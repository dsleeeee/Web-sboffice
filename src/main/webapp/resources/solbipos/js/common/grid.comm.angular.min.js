"use strict";function RootController(e,t,n,a){t.name=e,t._gridDataInit=function(){t.data=new wijmo.collections.CollectionView([])},t._inquiryMain=function(e,n,a){t._inquiry(e,n,a,!0,!0)},t._inquirySub=function(e,n,a,o){o||(o=!0),t._inquiry(e,n,a,o,!1)},t._inquiry=function(e,a,o,i,r){if(r)for(var c=angular.element("input"),l="",s=0,u=c.length;s<u;s+=1)(l=angular.element(c[s]).attr("ng-model"))&&t[l]&&(a[l]=t[l]);t._getCurrPage()>0?a.curr=t._getCurrPage():a.curr=1,n({method:"POST",url:e,params:a,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(e){if("OK"===e.data.status){var n=e.data.data.list;if(void 0===n.length||0===n.length)return t.data=new wijmo.collections.CollectionView([]),void(i&&t._popMsg(e.data.message));var a=new wijmo.collections.CollectionView(n);a.trackChanges=!0,t.data=a,e.data.data.page.curr&&(t.pagingInfo=e.data.data.page,t.pagingInfo.ctrlName=t.name,t._broadcast("drawPaging",t.pagingInfo))}else if("FAIL"===e.data.status)t._popMsg("Ajax Fail By HTTP Request");else if("SESSION_EXFIRE"===e.data.status)t._popMsg(e.data.message,function(){location.href=e.data.url});else if("SERVER_ERROR"===e.data.status)t._popMsg(e.data.message);else{var o=e.data.status+" : "+e.data.message;t._popMsg(o)}},function(e){return t._popMsg(messages["cmm.error"]),!1}).then(function(){"function"==typeof o&&setTimeout(function(){o()},10)})},t._addRow=function(e,n){var a=t.flex;a.collectionView||(a.itemsSource=new wijmo.collections.CollectionView);var o=a.collectionView.addNew();o.status="I",o.gChk=!0;for(var i in e)o[i]=e[i];a.collectionView.trackChanges=!0,a.collectionView.commitNew(),setTimeout(function(){a.scrollIntoView(a.rows.length-1,0),a.select(a.rows.length-1,1),a.focus(),a.startEditing(!0,a.rows.length-1,null===n?0:n,!0)},50)},t._save=function(e,a,o){a.length<=0?t._popMsg(messages["cmm.not.modify"]):(a=JSON.stringify(a),n({method:"POST",url:e,data:a,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(e){if("OK"===e.data.status)t._popMsg(messages["cmm.saveSucc"]),t.flex.collectionView.clearChanges();else if("FAIL"===e.data.status)t._popMsg("Ajax Fail By HTTP Request");else if("SESSION_EXFIRE"===e.data.status)t._popMsg(e.data.message,function(){location.href=e.data.url});else if("SERVER_ERROR"===e.data.status)t._popMsg(e.data.message);else{var n=e.data.status+" : "+e.data.message;t._popMsg(n)}},function(e){return t._popMsg(messages["cmm.saveFail"]),!1}).then(function(){"function"==typeof o&&setTimeout(function(){o()},10)}))},t._itemFormatter=function(e,n,o,i){if(e.cellType===wijmo.grid.CellType.ColumnHeader){t.flex.getMergedRange(e,n,o)&&(i.innerHTML='<div class="wj-header merged-custom">'+i.innerHTML+"</div>");var r=e.grid;if("gChk"===(u=r.columns[o]).binding||"checkBox"===u.format||"checkBoxText"===u.format){u.allowSorting=!1;for(var c=0,l=0;l<r.rows.length;l++)!0===r.getCellData(l,o)&&c++;"checkBoxText"===u.format?i.innerHTML='<input id="'+u.binding+'" type="checkbox" class="wj-cell-check" /><label for="'+u.binding+'" class="wj-header-label">'+i.innerHTML+"</label>":i.innerHTML='<input type="checkbox" class="wj-cell-check" />';var s=i.firstChild;s.checked=c>0,s.indeterminate=c>0&&c<r.rows.length,s.addEventListener("click",function(e){r.beginUpdate();for(var t=0;t<r.rows.length;t++)r.setCellData(t,o,s.checked);r.endUpdate()})}}else if(e.cellType===wijmo.grid.CellType.TopLeft)a||$(i).css({background:"none","background-color":"#e8e8e8"});else if(e.cellType===wijmo.grid.CellType.RowHeader)e.rows[n]instanceof wijmo.grid.GroupRow?i.textContent="":isEmpty(e._rows[n]._data.rnum)?i.textContent=(n+1).toString():i.textContent=e._rows[n]._data.rnum.toString();else if(e.cellType===wijmo.grid.CellType.Cell){var u;(u=e.columns[o]).isReadOnly&&wijmo.addClass(i,"wj-custom-readonly")}},t.$watch("flex",function(){var e=t.flex;e&&(e.beginningEdit.addHandler(function(t,n){"gChk"!==t.columns[n.col].binding&&(t.rows[n.row].dataItem.gChk?t.columns[n.col].dataType!==wijmo.DataType.Boolean&&setTimeout(function(){var e=t.getCellData(n.row,n.col,!0);null!==t.activeEditor&&""!==t.activeEditor.value&&wijmo.setSelectionRange(t.activeEditor,e.length)},0):(n.cancel=!0,e.endUpdate()))}),e.cellEditEnded.addHandler(function(e,t){}),e.rowEditEnded.addHandler(function(e,t){}))}),t._makePickColumns=function(e){var n=t.flex;n&&a&&n.hostElement.addEventListener("mousedown",function(a){n.hitTest(a).cellType===wijmo.grid.CellType.TopLeft&&(t.picker||(t.picker=new wijmo.grid.ColumnPicker("#"+e),t.picker.orgColumns=t.flex.columns),t.picker.grid=t.flex,t.colPicker.show(!0,function(e){var n=e.dialogResult;n&&n.indexOf("apply")>-1&&t.picker.save()}),a.preventDefault())})}}!function(e,t){var n=angular.module("rootApp",["wj","ngSanitize"]);n.controller("rootCtrl",["$scope","$http","$compile","comboData","pagingData",function(e,t,n,a,o){e.$on("loadingPopupActive",function(){e._loadingPopup.show(!0)}),e.$on("loadingPopupInactive",function(){e._loadingPopup.hide()}),e.$on("drawPaging",function(t,a){var o=a.pageScale,i=10===o?9:4,r="",c={};c.ctrlName=a.ctrlName,c.curr=a.curr,c.tot=a.totCnt,c.start=0,c.end=0;var l=a.curr/o;-1===l.toString().indexOf(".")?(c.end=a.curr,c.start=c.end-i):(c.start=parseInt(l)*o+1,c.end=c.start+i),c.end>a.totalPage&&(c.end=a.totalPage),a.totCnt>o&&(r+=wijmo.format('<li class="btn_previous" data-tot={tot}><a href="javascript:;"></a></li>',c));for(var s=c.start;s<=c.end;s++)c.i=s,c.cnm=s===a.curr?"on pagenav":"pagenav",r+=wijmo.format('<li><a href="javascript:;" class="{cnm}" data-value={i} ng-click="_pagingView(\'{ctrlName}\', \'{i}\');">{i}</a></li>',c);a.totalPage>o&&(r+=wijmo.format('<li class="btn_next" data-curr={curr}><a href="javascript:;"></a></li>',c));var u=n(r)(e),d=a.ctrlName+"Pager";angular.element(document.getElementById(d)).children().remove(),angular.element(document.getElementById(d)).append(u)}),e._broadcast=function(t,n){e.$broadcast("init"),e.$broadcast(t,n)},e._pagingView=function(t,n){e._setCurrPage(n),e.$broadcast(t)},e._popMsg=function(t,n){e.s_alert_msg=t,setTimeout(function(){e._alertPopup.show(!0,function(){"function"==typeof n&&setTimeout(function(){n()},50)})},100)},e._initComboBox=function(e){e._tbx.id=e._orgAtts.id.value,e._tbx.setAttribute("ng-model",e._orgAtts["ng-model"]),e._tbx.attributes["ng-model"].value=e._orgAtts["ng-model"].value},e._setCurrPage=function(e){o.set(e)},e._getCurrPage=function(){return o.get()},e._setComboData=function(e,t){a.set(e,t)},e._getComboData=function(e){return a.get(e)}}]),n.factory("myHttpInterceptor",function(e,t,n){return{request:function(e){return n.$broadcast("loadingPopupActive"),e},requestError:function(e){return console.log("from REQUEST ERROR"),n.$broadcast("loadingPopupInactive"),t.reject("Couldnot have a successfull request, Sorry :(")},response:function(e){return n.$broadcast("loadingPopupInactive"),e},responseError:function(e){return console.log("from RESPONSE ERROR"),n.$broadcast("loadingPopupInactive"),t.reject(e)}}}).factory("comboData",function(){var e=[];return e.set=function(t,n){e[t]=n},e.get=function(t){return e[t]},e}).factory("pagingData",function(){var e={set:function(t){e.value=t},get:function(){return e.value}};return e}),n.config(function(e){e.interceptors.push("myHttpInterceptor")});var a={getApp:function(){return n},getScope:function(e){var t='div[ng-controller="'+e+'"]';return angular.element(t).scope()}};e.agrid=a}("undefined"!=typeof window?window:this,angular);
