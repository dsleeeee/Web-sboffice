<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.solbipos.sys.persistence.auth.authgroup.AuthGroupMapper">

  <select id="selectGroup" parameterType="authGroup" resultType="DefaultMap">
    /* AuthGroupMapper.selectGroup */
     SELECT ROW_NUMBER() OVER (PARTITION BY 1 ORDER BY 1) NO,
            GRP_CD,
            GRP_NM,
            TARGET_ALL_FG,
            (SELECT NMCODE_NM FROM TB_CM_NMCODE WHERE NMCODE_GRP_CD = '903' AND NMCODE_CD = A.TARGET_ALL_FG) TARGET_ALL_FG_NM,
            TARGET_ORGN,
            ( SELECT MAX(TARGET_ORGN_NM)
                FROM ( SELECT HQ_OFFICE_NM TARGET_ORGN_NM FROM TB_HQ_OFFICE WHERE HQ_OFFICE_CD = A.TARGET_ORGN
                       UNION ALL
                       SELECT AGENCY_NM TARGET_ORGN_NM FROM TB_CM_AGENCY WHERE AGENCY_CD = A.TARGET_ORGN
                )
            ) TARGET_ORGN_NM,
            REMARK,
            USE_YN,
            REG_DT,
            REG_ID,
            MOD_DT,
            MOD_ID
       FROM TB_WB_AUTHOR_GRP_INFO A
  </select>
  
  <insert id="insertGroup" parameterType="authGroup">
    /* AuthGroupMapper.insertGroup */
    INSERT INTO TB_WB_AUTHOR_GRP_INFO
    (
      REMARK,
      REG_DT,
      REG_ID,
      MOD_DT,
      MOD_ID
    )
    VALUES
    (
      #{remark},
      #{regDt},
      #{regId},
      #{modDt},
      #{modId}
    )
  </insert>

  <update id="updateDclzManage" parameterType="dclzManage">
  <![CDATA[
    /* DclzManageMapper.updateDclzManage */
    UPDATE TB_PS_EMPLOYEE_COMMTE A
       SET A.EMP_IN_DATE = #{empInDate},
           A.SALE_DATE = #{saleDate},
           A.EMP_IN_DT = #{empInDt},
           A.EMP_OUT_DT = #{empOutDt},
           A.WORK_TIME = #{workTime},
           A.REMARK = #{remark},
           A.MOD_DT = #{modDt},
           A.MOD_ID = #{modId}
     WHERE A.STORE_CD = #{storeCd}
       AND A.EMP_NO = #{empNo}
       AND A.EMP_IN_DATE = #{empInDate}
  ]]>
  </update>
  
  <delete id="deleteDclzManage" parameterType="dclzManage">
  <![CDATA[
    /* DclzManageMapper.deleteDclzManage */
    DELETE 
      FROM TB_PS_EMPLOYEE_COMMTE A
     WHERE A.STORE_CD = #{storeCd}
       AND A.EMP_NO = #{empNo}
       AND A.EMP_IN_DATE = #{empInDate}
  ]]>
  </delete>

  <select id="selectStoreEmployee" parameterType="dclzManage" resultType="DefaultMap">
  <![CDATA[
    /* DclzManageMapper.selectStoreEmployee */
    SELECT A.STORE_CD,
           A.EMP_NO,
           A.EMP_NM
      FROM TB_MS_EMPLOYEE A
     WHERE A.STORE_CD = #{storeCd}
  ]]>
  </select>
  
  <select id="selectWorkCheck" parameterType="dclzManage" resultType="integer">
    /* DclzManageMapper.selectWorkCheck */
    SELECT COUNT(*)
      FROM TB_PS_EMPLOYEE_COMMTE A
     WHERE A.STORE_CD = #{storeCd}
       AND A.EMP_NO = #{empNo}
       AND A.EMP_IN_DATE = #{empInDate}
  </select>
  
</mapper>



