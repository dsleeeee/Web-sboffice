<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    SaleAnalysisByTime.xml
    시간대별 매출분석 sql
    ======================================================
    No  ||  수정자 ||  수정일자    ||  수정내역
    ======================================================
    1       김유승     2025.10.01
-->
<mapper namespace="kr.co.solbipos.kookmin.saleAnalysis.saleAnalysisByTime.service.impl.SaleAnalysisByTimeMapper">

    <!-- 시간대별 매출분석 조회 -->
    <!--
        TABLE    :
        COMMENTS : 시간대별 매출분석을 조회한다.
    -->
    <select id="getSaleAnalysisByTimeList" parameterType="SaleAnalysisByTimeVO" resultType="DefaultMap">
        /* SaleAnalysisByTimeMapper.getSaleAnalysisByTimeList */
        WITH BASE AS
        (
            SELECT 	A.STORE_CD
            ,		B.STORE_NM
            ,		TO_CHAR(TO_DATE(A.SALE_DATE, 'yyyymmdd'), 'yyyy-mm-dd')   AS SALE_DATE
            ,		TO_CHAR(TO_DATE(A.SALE_DATE, 'YYYYMMDD'), 'DY') AS YOIL
            ,		A.SALE_HOUR
            ,		A.GUEST_CNT_1
            ,		A.TOT_SALE_AMT
            ,    	CASE
                            WHEN A.GUEST_CNT_1 IS NOT NULL AND A.GUEST_CNT_1 != 0 
                            THEN A.TOT_SALE_AMT / A.GUEST_CNT_1 * SIGN(A.TOT_SALE_AMT)
                            ELSE 0
                    END AS GUEST_AMT
            ,		A.SALE_QTY
            FROM 	TB_SL_DAILY_TIME A
            , 		TB_MS_STORE B
            WHERE	B.STORE_CD = A.STORE_CD
            AND 	A.HQ_OFFICE_CD = #{hqOfficeCd}
            AND 	A.SALE_DATE BETWEEN #{startDate} AND #{endDate}
            AND 	A.SALE_HOUR BETWEEN '06' AND '23'
            <if test='storeCdQuery != null and storeCdQuery != ""'>
                AND A.STORE_CD IN (${storeCdQuery})
            </if>
            <if test="yoil != null">
                AND     TO_CHAR(TO_DATE(A.SALE_DATE, 'YYYYMMDD'), 'DY') IN
                <foreach collection="yoilList" item="item" open=" (" separator="," close=")" >
                    #{item}
                </foreach>
            </if>
        )
        <if test="guestCnt != null and guestCnt != ''">
        SELECT 	1 AS NUM
        ,		STORE_CD
        ,		STORE_NM
        ,		SALE_DATE
        ,		YOIL
        ,       '객수'  AS  ROW_FG
        ,		ROUND(NVL(H6_GUEST_CNT, 0), 0) AS SALE_ANALS_H6, ROUND(NVL(H7_GUEST_CNT, 0), 0) AS SALE_ANALS_H7, ROUND(NVL(H8_GUEST_CNT, 0), 0) AS SALE_ANALS_H8
        , 		ROUND(NVL(H9_GUEST_CNT, 0), 0) AS SALE_ANALS_H9, ROUND(NVL(H10_GUEST_CNT, 0), 0) AS SALE_ANALS_H10, ROUND(NVL(H11_GUEST_CNT, 0), 0) AS SALE_ANALS_H11
        , 		ROUND(NVL(H12_GUEST_CNT, 0), 0) AS SALE_ANALS_H12, ROUND(NVL(H13_GUEST_CNT, 0), 0) AS SALE_ANALS_H13, ROUND(NVL(H14_GUEST_CNT, 0), 0) AS SALE_ANALS_H14
        , 		ROUND(NVL(H15_GUEST_CNT, 0), 0) AS SALE_ANALS_H15, ROUND(NVL(H16_GUEST_CNT, 0), 0) AS SALE_ANALS_H16, ROUND(NVL(H17_GUEST_CNT, 0), 0) AS SALE_ANALS_H17
        , 		ROUND(NVL(H18_GUEST_CNT, 0), 0) AS SALE_ANALS_H18, ROUND(NVL(H19_GUEST_CNT, 0), 0) AS SALE_ANALS_H19, ROUND(NVL(H20_GUEST_CNT, 0), 0) AS SALE_ANALS_H20
        , 		ROUND(NVL(H21_GUEST_CNT, 0), 0) AS SALE_ANALS_H21, ROUND(NVL(H22_GUEST_CNT, 0), 0) AS SALE_ANALS_H22, ROUND(NVL(H23_GUEST_CNT, 0), 0) AS SALE_ANALS_H23
        ,	    ROUND(NVL(H6_GUEST_CNT, 0) + NVL(H7_GUEST_CNT, 0) + NVL(H8_GUEST_CNT, 0) + NVL(H9_GUEST_CNT, 0) + NVL(H10_GUEST_CNT, 0) + NVL(H11_GUEST_CNT, 0) +
                NVL(H12_GUEST_CNT, 0) + NVL(H13_GUEST_CNT, 0) + NVL(H14_GUEST_CNT, 0) + NVL(H15_GUEST_CNT, 0) + NVL(H16_GUEST_CNT, 0) + NVL(H17_GUEST_CNT, 0) +
                NVL(H18_GUEST_CNT, 0) + NVL(H19_GUEST_CNT, 0) + NVL(H20_GUEST_CNT, 0) + NVL(H21_GUEST_CNT, 0) + NVL(H22_GUEST_CNT, 0) + NVL(H23_GUEST_CNT, 0), 0) AS TOT_SALE_ANALS
        FROM
            (
                SELECT 	STORE_CD
                , 		STORE_NM
                , 		SALE_DATE
                , 		SALE_HOUR
                , 		GUEST_CNT_1
                ,		YOIL
                FROM 	BASE
                WHERE 	GUEST_CNT_1 IS NOT NULL
            )
        PIVOT
            (
                SUM(GUEST_CNT_1) AS GUEST_CNT
                FOR SALE_HOUR IN (
                '06' AS H6, '07' AS H7, '08' AS H8, '09' AS H9, '10' AS H10, '11' AS H11, '12' AS H12, '13' AS H13,
                '14' AS H14, '15' AS H15, '16' AS H16, '17' AS H17, '18' AS H18, '19' AS H19, '20' AS H20, '21' AS H21,
                '22' AS H22, '23' AS H23
                )
            )
        UNION ALL
        </if>
        <if test="totSaleAmt != null and totSaleAmt != ''">
        SELECT 	2 AS NUM
        ,		STORE_CD
        ,		STORE_NM
        ,		SALE_DATE
        ,		YOIL
        ,       '매출'  AS  ROW_FG
        ,		ROUND(NVL(H6_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H6, ROUND(NVL(H7_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H7, ROUND(NVL(H8_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H8
        , 		ROUND(NVL(H9_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H9, ROUND(NVL(H10_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H10, ROUND(NVL(H11_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H11
        , 		ROUND(NVL(H12_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H12, ROUND(NVL(H13_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H13, ROUND(NVL(H14_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H14
        , 		ROUND(NVL(H15_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H15, ROUND(NVL(H16_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H16, ROUND(NVL(H17_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H17
        , 		ROUND(NVL(H18_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H18, ROUND(NVL(H19_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H19, ROUND(NVL(H20_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H20
        , 		ROUND(NVL(H21_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H21, ROUND(NVL(H22_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H22, ROUND(NVL(H23_TOT_SALE_AMT, 0), 0) AS SALE_ANALS_H23
        ,	    ROUND(NVL(H6_TOT_SALE_AMT, 0) + NVL(H7_TOT_SALE_AMT, 0) + NVL(H8_TOT_SALE_AMT, 0) + NVL(H9_TOT_SALE_AMT, 0) + NVL(H10_TOT_SALE_AMT, 0) + NVL(H11_TOT_SALE_AMT, 0) +
                NVL(H12_TOT_SALE_AMT, 0) + NVL(H13_TOT_SALE_AMT, 0) + NVL(H14_TOT_SALE_AMT, 0) + NVL(H15_TOT_SALE_AMT, 0) + NVL(H16_TOT_SALE_AMT, 0) + NVL(H17_TOT_SALE_AMT, 0) +
                NVL(H18_TOT_SALE_AMT, 0) + NVL(H19_TOT_SALE_AMT, 0) + NVL(H20_TOT_SALE_AMT, 0) + NVL(H21_TOT_SALE_AMT, 0) + NVL(H22_TOT_SALE_AMT, 0) + NVL(H23_TOT_SALE_AMT, 0),0) AS TOT_SALE_ANALS
        FROM
            (
                SELECT 	STORE_CD
                , 		STORE_NM
                , 		SALE_DATE
                ,		YOIL
                , 		SALE_HOUR
                , 		TOT_SALE_AMT
                FROM 	BASE
                WHERE 	TOT_SALE_AMT IS NOT NULL
            )
        PIVOT
            (
                SUM(TOT_SALE_AMT) AS TOT_SALE_AMT
                FOR SALE_HOUR IN (
                '06' AS H6, '07' AS H7, '08' AS H8, '09' AS H9, '10' AS H10, '11' AS H11, '12' AS H12, '13' AS H13,
                '14' AS H14, '15' AS H15, '16' AS H16, '17' AS H17, '18' AS H18, '19' AS H19, '20' AS H20, '21' AS H21,
                '22' AS H22, '23' AS H23
                )
            )
        UNION ALL
        </if>
        <if test="guestAmt != null and guestAmt != ''">
        SELECT 	3 AS NUM
        ,		STORE_CD
        ,		STORE_NM
        ,		SALE_DATE
        ,		YOIL
        ,       '객단가'  AS  ROW_FG
        ,		ROUND(NVL(H6_GUEST_AMT, 0), 0) AS SALE_ANALS_H6, ROUND(NVL(H7_GUEST_AMT, 0), 0) AS SALE_ANALS_H7, ROUND(NVL(H8_GUEST_AMT, 0), 0) AS SALE_ANALS_H8
        , 		ROUND(NVL(H9_GUEST_AMT, 0), 0) AS SALE_ANALS_H9, ROUND(NVL(H10_GUEST_AMT, 0), 0) AS SALE_ANALS_H10, ROUND(NVL(H11_GUEST_AMT, 0), 0) AS SALE_ANALS_H11
        , 		ROUND(NVL(H12_GUEST_AMT, 0), 0) AS SALE_ANALS_H12, ROUND(NVL(H13_GUEST_AMT, 0), 0) AS SALE_ANALS_H13, ROUND(NVL(H14_GUEST_AMT, 0), 0) AS SALE_ANALS_H14
        , 		ROUND(NVL(H15_GUEST_AMT, 0), 0) AS SALE_ANALS_H15, ROUND(NVL(H16_GUEST_AMT, 0), 0) AS SALE_ANALS_H16, ROUND(NVL(H17_GUEST_AMT, 0), 0) AS SALE_ANALS_H17
        , 		ROUND(NVL(H18_GUEST_AMT, 0), 0) AS SALE_ANALS_H18, ROUND(NVL(H19_GUEST_AMT, 0), 0) AS SALE_ANALS_H19, ROUND(NVL(H20_GUEST_AMT, 0), 0) AS SALE_ANALS_H20
        , 		ROUND(NVL(H21_GUEST_AMT, 0), 0) AS SALE_ANALS_H21, ROUND(NVL(H22_GUEST_AMT, 0), 0) AS SALE_ANALS_H22, ROUND(NVL(H23_GUEST_AMT, 0), 0) AS SALE_ANALS_H23
        ,	    ROUND(NVL(H6_GUEST_AMT, 0) + NVL(H7_GUEST_AMT, 0) + NVL(H8_GUEST_AMT, 0) + NVL(H9_GUEST_AMT, 0) + NVL(H10_GUEST_AMT, 0) + NVL(H11_GUEST_AMT, 0) +
                NVL(H12_GUEST_AMT, 0) + NVL(H13_GUEST_AMT, 0) + NVL(H14_GUEST_AMT, 0) + NVL(H15_GUEST_AMT, 0) + NVL(H16_GUEST_AMT, 0) + NVL(H17_GUEST_AMT, 0) +
                NVL(H18_GUEST_AMT, 0) + NVL(H19_GUEST_AMT, 0) + NVL(H20_GUEST_AMT, 0) + NVL(H21_GUEST_AMT, 0) + NVL(H22_GUEST_AMT, 0) + NVL(H23_GUEST_AMT, 0),0) AS TOT_SALE_ANALS
        FROM
            (
                SELECT 	STORE_CD
                , 		STORE_NM
                , 		SALE_DATE
                ,		YOIL
                , 		SALE_HOUR
                , 		GUEST_AMT
                FROM 	BASE
                WHERE 	GUEST_AMT IS NOT NULL
            )
        PIVOT
            (
                SUM(GUEST_AMT) AS GUEST_AMT
                FOR SALE_HOUR IN (
                '06' AS H6, '07' AS H7, '08' AS H8, '09' AS H9, '10' AS H10, '11' AS H11, '12' AS H12, '13' AS H13,
                '14' AS H14, '15' AS H15, '16' AS H16, '17' AS H17, '18' AS H18, '19' AS H19, '20' AS H20, '21' AS H21,
                '22' AS H22, '23' AS H23
                )
            )
        UNION ALL
        </if>
        <if test="saleQty != null and saleQty != ''">
        SELECT 	4 AS NUM
        ,		STORE_CD
        ,		STORE_NM
        ,		SALE_DATE
        ,		YOIL
        ,       '수량'  AS  ROW_FG
        ,		ROUND(NVL(H6_SALE_QTY, 0), 0) AS SALE_ANALS_H6, ROUND(NVL(H7_SALE_QTY, 0), 0) AS SALE_ANALS_H7, ROUND(NVL(H8_SALE_QTY, 0), 0) AS SALE_ANALS_H8
        , 		ROUND(NVL(H9_SALE_QTY, 0), 0) AS SALE_ANALS_H9, ROUND(NVL(H10_SALE_QTY, 0), 0) AS SALE_ANALS_H10, ROUND(NVL(H11_SALE_QTY, 0), 0) AS SALE_ANALS_H11
        , 		ROUND(NVL(H12_SALE_QTY, 0), 0) AS SALE_ANALS_H12, ROUND(NVL(H13_SALE_QTY, 0), 0) AS SALE_ANALS_H13, ROUND(NVL(H14_SALE_QTY, 0), 0) AS SALE_ANALS_H14
        , 		ROUND(NVL(H15_SALE_QTY, 0), 0) AS SALE_ANALS_H15, ROUND(NVL(H16_SALE_QTY, 0), 0) AS SALE_ANALS_H16, ROUND(NVL(H17_SALE_QTY, 0), 0) AS SALE_ANALS_H17
        , 		ROUND(NVL(H18_SALE_QTY, 0), 0) AS SALE_ANALS_H18, ROUND(NVL(H19_SALE_QTY, 0), 0) AS SALE_ANALS_H19, ROUND(NVL(H20_SALE_QTY, 0), 0) AS SALE_ANALS_H20
        , 		ROUND(NVL(H21_SALE_QTY, 0), 0) AS SALE_ANALS_H21, ROUND(NVL(H22_SALE_QTY, 0), 0) AS SALE_ANALS_H22, ROUND(NVL(H23_SALE_QTY, 0), 0) AS SALE_ANALS_H23
        ,	    ROUND(NVL(H6_SALE_QTY, 0) + NVL(H7_SALE_QTY, 0) + NVL(H8_SALE_QTY, 0) + NVL(H9_SALE_QTY, 0) + NVL(H10_SALE_QTY, 0) + NVL(H11_SALE_QTY, 0) +
                NVL(H12_SALE_QTY, 0) + NVL(H13_SALE_QTY, 0) + NVL(H14_SALE_QTY, 0) + NVL(H15_SALE_QTY, 0) + NVL(H16_SALE_QTY, 0) + NVL(H17_SALE_QTY, 0) +
                NVL(H18_SALE_QTY, 0) + NVL(H19_SALE_QTY, 0) + NVL(H20_SALE_QTY, 0) + NVL(H21_SALE_QTY, 0) + NVL(H22_SALE_QTY, 0) + NVL(H23_SALE_QTY, 0),0) AS TOT_SALE_ANALS
        FROM
            (
                SELECT 	STORE_CD
                , 		STORE_NM
                , 		SALE_DATE
                ,		YOIL
                , 		SALE_HOUR
                , 		SALE_QTY
                FROM 	BASE
                WHERE 	SALE_QTY IS NOT NULL
            )
        PIVOT
            (
                SUM(SALE_QTY) AS SALE_QTY
                FOR SALE_HOUR IN (
                '06' AS H6, '07' AS H7, '08' AS H8, '09' AS H9, '10' AS H10, '11' AS H11, '12' AS H12, '13' AS H13,
                '14' AS H14, '15' AS H15, '16' AS H16, '17' AS H17, '18' AS H18, '19' AS H19, '20' AS H20, '21' AS H21,
                '22' AS H22, '23' AS H23
                )
            )
        UNION ALL
        </if>
        <if test="totSaleAmt != null and totSaleAmt != ''">
        SELECT	5 AS NUM
        ,		'' 	AS STORE_CD
        ,		''  AS STORE_NM
        ,		''  AS SALE_DATE
        ,		'' 	AS YOIL
        ,       '매출 합계'  AS  ROW_FG
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '06' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H6
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '07' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H7
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '08' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H8
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '09' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H9
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '10' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H10
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '11' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H11
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '12' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H12
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '13' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H13
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '14' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H14
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '15' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H15
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '16' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H16
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '17' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H17
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '18' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H18
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '19' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H19
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '20' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H20
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '21' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H21
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '22' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H22
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '23' THEN TOT_SALE_AMT END), 0), 0) AS SALE_ANALS_H23
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END), 0), 0) AS TOT_SALE_ANALS
        FROM	BASE
        HAVING COUNT(*) > 0
        UNION ALL
        </if>
        <if test="guestCnt != null and guestCnt != ''">
        SELECT	6 AS NUM
        ,		'' 	AS STORE_CD
        ,		''  AS STORE_NM
        ,		''  AS SALE_DATE
        ,		'' 	AS YOIL
        ,       '객수 합계'  AS  ROW_FG
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '06' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H6
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '07' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H7
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '08' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H8
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '09' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H9
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '10' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H10
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '11' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H11
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '12' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H12
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '13' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H13
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '14' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H14
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '15' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H15
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '16' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H16
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '17' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H17
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '18' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H18
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '19' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H19
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '20' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H20
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '21' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H21
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '22' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H22
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '23' THEN GUEST_CNT_1 END), 0), 0) AS SALE_ANALS_H23
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN GUEST_CNT_1 END), 0), 0) AS TOT_SALE_ANALS
        FROM	BASE
        HAVING COUNT(*) > 0
        UNION ALL
        </if>
        <if test="saleQty != null and saleQty != ''">
        SELECT	7 AS NUM
        ,		'' 	AS STORE_CD
        ,		''  AS STORE_NM
        ,		''  AS SALE_DATE
        ,		'' 	AS YOIL
        ,       '수량 합계'  AS  ROW_FG
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '06' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H6
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '07' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H7
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '08' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H8
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '09' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H9
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '10' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H10
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '11' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H11
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '12' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H12
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '13' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H13
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '14' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H14
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '15' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H15
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '16' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H16
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '17' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H17
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '18' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H18
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '19' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H19
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '20' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H20
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '21' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H21
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '22' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H22
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '23' THEN SALE_QTY END), 0), 0) AS SALE_ANALS_H23
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN SALE_QTY END), 0), 0) AS TOT_SALE_ANALS
        FROM	BASE
        HAVING COUNT(*) > 0
        <if test="totSaleAmt != null and totSaleAmt != ''">
            UNION ALL
        </if>
        </if>
        <if test="totSaleAmt != null and totSaleAmt != ''">
        SELECT	8 AS NUM
        ,		'' 	AS STORE_CD
        ,		''  AS STORE_NM
        ,		''  AS SALE_DATE
        ,		'' 	AS YOIL
        ,       '매출 평균'  AS  ROW_FG
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '06' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H6
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '07' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H7
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '08' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H8
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '09' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H9
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '10' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H10
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '11' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H11
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '12' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H12
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '13' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H13
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '14' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H14
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '15' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H15
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '16' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H16
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '17' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H17
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '18' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H18
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '19' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H19
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '20' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H20
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '21' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H21
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '22' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H22
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '23' THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS SALE_ANALS_H23
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0), 0) AS TOT_SALE_ANALS
        FROM	BASE
        ,		(
                    SELECT	COUNT(DISTINCT SALE_DATE) AS CNT
                    FROM	BASE
                ) B
        GROUP
        BY		B.CNT
        UNION ALL
        </if>
        <if test="guestCnt != null and guestCnt != ''">
        SELECT	9 AS NUM
        ,		'' 	AS STORE_CD
        ,		''  AS STORE_NM
        ,		''  AS SALE_DATE
        ,		'' 	AS YOIL
        ,       '객수 평균'  AS  ROW_FG
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '06' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H6
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '07' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H7
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '08' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H8
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '09' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H9
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '10' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H10
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '11' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H11
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '12' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H12
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '13' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H13
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '14' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H14
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '15' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H15
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '16' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H16
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '17' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H17
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '18' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H18
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '19' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H19
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '20' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H20
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '21' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H21
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '22' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H22
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '23' THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS SALE_ANALS_H23
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN GUEST_CNT_1 END) / B.CNT, 0), 0) AS TOT_SALE_ANALS
        FROM	BASE
        ,		(
                    SELECT	COUNT(DISTINCT SALE_DATE) AS CNT
                    FROM	BASE
                ) B
        GROUP
        BY		B.CNT
        <if test="totSaleAmt != null and totSaleAmt != ''">
            UNION ALL
        </if>
        </if>
        <if test="saleQty != null and saleQty != ''">
        SELECT	10 AS NUM
        ,		'' 	AS STORE_CD
        ,		''  AS STORE_NM
        ,		''  AS SALE_DATE
        ,		'' 	AS YOIL
        ,       '수량 평균'  AS  ROW_FG
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '06' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H6
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '07' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H7
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '08' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H8
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '09' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H9
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '10' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H10
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '11' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H11
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '12' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H12
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '13' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H13
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '14' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H14
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '15' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H15
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '16' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H16
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '17' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H17
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '18' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H18
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '19' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H19
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '20' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H20
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '21' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H21
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '22' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H22
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '23' THEN SALE_QTY END) / B.CNT, 0), 0) AS SALE_ANALS_H23
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN SALE_QTY END) / B.CNT, 0), 0) AS TOT_SALE_ANALS
        FROM	BASE
        ,		(
                    SELECT	COUNT(DISTINCT SALE_DATE) AS CNT
                    FROM	BASE
                ) B
        GROUP
        BY		B.CNT
        <if test="totSaleAmt != null and totSaleAmt != ''">
        UNION ALL
        </if>
        </if>
        <if test="totSaleAmt != null and totSaleAmt != ''">
        SELECT	11 AS NUM
        ,		'' 	AS STORE_CD
        ,		''  AS STORE_NM
        ,		''  AS SALE_DATE
        ,		'' 	AS YOIL
        ,       '매출 비중'  AS  ROW_FG
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '06' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H6
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '07' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H7
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '08' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H8
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '09' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H9
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '10' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H10
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '11' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H11
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '12' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H12
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '13' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H13
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '14' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H14
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '15' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H15
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '16' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H16
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '17' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H17
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '18' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H18
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '19' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H19
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '20' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H20
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '21' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H21
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '22' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H22
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR = '23' THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS SALE_ANALS_H23
        ,		ROUND(NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) / NVL(SUM(CASE WHEN SALE_HOUR NOT IN ('00','01','02','03','04','05')  THEN TOT_SALE_AMT END) / B.CNT, 0) * 100, 0) AS TOT_SALE_ANALS
        FROM	BASE
        ,		(
                    SELECT	COUNT(DISTINCT SALE_DATE) AS CNT
                    FROM	BASE
                ) B
        GROUP
        BY		B.CNT
        </if>
        ORDER
        BY 		SALE_DATE
        , 		STORE_CD
        , 		NUM
    </select>
</mapper>