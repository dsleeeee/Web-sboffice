<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.solbipos.membr.info.point.service.impl.MemberPointMapper">

  <!-- 회원 포인트 리스트 조회-->
  <!--
      TABLE    : TB_MB_MEMBER_POINT
      COMMENTS : 회원 포인트 조회
  -->
  <select id="getMemberPointList" parameterType="memberPointVO" resultType="DefaultMap">
      /* MemberClassMapper.getMemberClassList */
      SELECT
          MEMBR_ORGN_CD
          ,MEMBR_NO
          ,AVABL_POINT
      FROM
          TB_MB_MEMBER_POINT
  </select>

<!--  <insert id="adjustAllBackUp" parameterType="DefaultMap">-->
<!--    INSERT INTO-->
<!--      TB_MB_MEMBER_POINT_HIST-->
<!--        (MEMBR_ORGN_CD,-->
<!--        MEMBR_NO,-->
<!--        CHG_DATE,-->
<!--        CHG_SEQ,-->
<!--        POINT_CHG_FG,-->
<!--        CHG_POINT,-->
<!--        REMARK,-->
<!--        ORGN_APPR_NO,-->
<!--        REG_DT,-->
<!--        REG_ID,-->
<!--        MOD_DT,-->
<!--        MOD_ID)-->
<!--    VALUES (-->
<!--        #{membrOrgnCd},-->
<!--        #{membrNo},-->
<!--        #{chgDate},-->
<!--        #{chgSeq},-->
<!--        3,-->
<!--        #{totAjdPoint},-->
<!--        #{adjustPartRemark},-->
<!--        #{orgnApprNo},-->
<!--        #{regDt},-->
<!--        #{regId},-->
<!--        #{modDt},-->
<!--        #{modId}-->
<!--    )-->
<!--  </insert>-->

  <insert id="adjustAll" parameterType="DefaultMap">
    INSERT INTO
	    TB_MB_MEMBER_POINT_HIST ( MEMBR_ORGN_CD , MEMBR_NO , CHG_DATE , CHG_SEQ , POINT_CHG_FG , CHG_POINT , REMARK , REG_DT , REG_ID, MOD_DT , MOD_ID )
    SELECT
        tmmp.MEMBR_ORGN_CD,
        tmmp.MEMBR_NO,
        #{chgDate},
        SQ_TB_MEMBER_POINT_HIST.NEXTVAL,
        '3',
        #{totAjdPoint} - tmmp.AVABL_POINT,
        #{remark},
        #{regDt},
        #{regId},
        #{modDt},
        #{modId}
    FROM
        TB_MB_MEMBER_POINT tmmp
    WHERE
        MEMBR_ORGN_CD = 'A0001'
--         AND MEMBR_NO = '0000000002';
  </insert>

</mapper>
