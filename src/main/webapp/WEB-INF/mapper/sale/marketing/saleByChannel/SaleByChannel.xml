<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    SaleByChannelVO.xml
    채널별매출
    ======================================================
    No  ||  수정자 ||  수정일자    ||  수정내역
    ======================================================
    1       김유승     2025.07.25     최초작성
-->
<mapper namespace="kr.co.solbipos.sale.marketing.saleByChannel.service.impl.SaleByChannelMapper">
    <!-- 채널별매출 - 조회 -->
    <!--
        TABLE    :
        COMMENTS :
    -->
    <select id="getSaleByChannelList" parameterType="SaleByChannelVO" resultType="DefaultMap">
        /* SaleByChannelMapper.getSaleByChannelList */
        SELECT 	TO_CHAR(TO_DATE(A.SALE_DATE , 'yyyymmdd'), 'yyyy-mm-dd') AS SALE_DATE
        ,		TO_CHAR(TO_DATE(A.SALE_DATE , 'yyyymmdd'), 'DY') AS YOIL
        ,		A.STORE_CD
        ,		B.STORE_NM
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG END),0) 			AS REAL_SALE_CNT_COMM0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 			AS REAL_SALE_CNT_DLVR0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0)      AS REAL_SALE_CNT_PACK0
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG  END),0) 						AS REAL_SALE_CNT_COMM1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 						AS REAL_SALE_CNT_DLVR1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0) 	    		AS REAL_SALE_CNT_PACK1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG  END),0) 						AS REAL_SALE_CNT_COMM3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 						AS REAL_SALE_CNT_DLVR3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0) 	    		AS REAL_SALE_CNT_PACK3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG  END),0) 						AS REAL_SALE_CNT_COMM4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 						AS REAL_SALE_CNT_DLVR4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0) 	    		AS REAL_SALE_CNT_PACK4
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG  END),0) 				AS REAL_SALE_CNT_COMM5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 				AS REAL_SALE_CNT_DLVR5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0) 		AS REAL_SALE_CNT_PACK5
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG  END),0) 					AS REAL_SALE_CNT_COMM13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 						AS REAL_SALE_CNT_DLVR13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0) 				AS REAL_SALE_CNT_PACK13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG  END),0) 					AS REAL_SALE_CNT_COMM12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 						AS REAL_SALE_CNT_DLVR12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0) 				AS REAL_SALE_CNT_PACK12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.SALE_FG  END),0) 						AS REAL_SALE_CNT_COMM9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.SALE_FG END),0) 						AS REAL_SALE_CNT_DLVR9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.SALE_FG END),0) 	    		AS REAL_SALE_CNT_PACK9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','5','13','12','9') THEN A.SALE_FG END),0)  			AS REAL_SALE_CNT_ETC
        ,       NVL(SUM(A.SALE_FG),0)    AS REAL_SALE_CNT_SUM
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT END),0) 			AS TOT_SALE_AMT_COMM0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			AS TOT_SALE_AMT_DLVR0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 	AS TOT_SALE_AMT_PACK0
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 				AS TOT_SALE_AMT_COMM1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    	AS TOT_SALE_AMT_DLVR1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 			AS TOT_SALE_AMT_PACK1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 				AS TOT_SALE_AMT_COMM3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    	AS TOT_SALE_AMT_DLVR3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 			AS TOT_SALE_AMT_PACK3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 				AS TOT_SALE_AMT_COMM4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    	AS TOT_SALE_AMT_DLVR4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 			AS TOT_SALE_AMT_PACK4
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			AS TOT_SALE_AMT_COMM5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			AS TOT_SALE_AMT_DLVR5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 	AS TOT_SALE_AMT_PACK5
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 				AS TOT_SALE_AMT_COMM13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 				AS TOT_SALE_AMT_DLVR13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 	    	AS TOT_SALE_AMT_PACK13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 				AS TOT_SALE_AMT_COMM12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 				AS TOT_SALE_AMT_DLVR12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 	    	AS TOT_SALE_AMT_PACK12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 				AS TOT_SALE_AMT_COMM9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    	AS TOT_SALE_AMT_DLVR9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 			AS TOT_SALE_AMT_PACK9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','5','13','12','9') THEN A.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_ETC
        ,       NVL(SUM(A.TOT_SALE_AMT),0)    AS TOT_SALE_AMT_SUM
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_COMM0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		AS TOT_DC_AMT_PACK0
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 					AS TOT_DC_AMT_COMM1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 					AS TOT_DC_AMT_DLVR1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_PACK1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 					AS TOT_DC_AMT_COMM3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 					AS TOT_DC_AMT_DLVR3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_PACK3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 					AS TOT_DC_AMT_COMM4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 					AS TOT_DC_AMT_DLVR4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_PACK4
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 			AS TOT_DC_AMT_COMM5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_DLVR5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		AS TOT_DC_AMT_PACK5
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 			    	AS TOT_DC_AMT_COMM13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 					AS TOT_DC_AMT_DLVR13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_PACK13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 			    	AS TOT_DC_AMT_COMM12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 					AS TOT_DC_AMT_DLVR12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_PACK12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 					AS TOT_DC_AMT_COMM9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 					AS TOT_DC_AMT_DLVR9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_PACK9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','5','13','12','9') THEN A.TOT_DC_AMT END),0) 		AS TOT_DC_AMT_ETC
        ,       NVL(SUM(A.TOT_DC_AMT),0)    AS TOT_DC_AMT_SUM
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_COMM0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR0
        ,		NVL(SUM(CASE WHEN (A.DLVR_IN_FG = '0' OR A.DLVR_IN_FG IS NULL) AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	AS REAL_SALE_AMT_PACK0
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 				AS REAL_SALE_AMT_COMM1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 				AS REAL_SALE_AMT_DLVR1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    	AS REAL_SALE_AMT_PACK1
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 				AS REAL_SALE_AMT_COMM3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 				AS REAL_SALE_AMT_DLVR3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    	AS REAL_SALE_AMT_PACK3
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 				AS REAL_SALE_AMT_COMM4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 				AS REAL_SALE_AMT_DLVR4
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    	AS REAL_SALE_AMT_PACK4
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 		AS REAL_SALE_AMT_COMM5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR5
        ,		NVL(SUM(CASE WHEN C.TEMPORARY_PAY_CD = '08' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	AS REAL_SALE_AMT_PACK5
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 				AS REAL_SALE_AMT_COMM13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 				AS REAL_SALE_AMT_DLVR13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 		AS REAL_SALE_AMT_PACK13
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 				AS REAL_SALE_AMT_COMM12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 				AS REAL_SALE_AMT_DLVR12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 		AS REAL_SALE_AMT_PACK12
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 				AS REAL_SALE_AMT_COMM9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 				AS REAL_SALE_AMT_DLVR9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	   		AS REAL_SALE_AMT_PACK9
        ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','5','13','12','9') THEN A.REAL_SALE_AMT END),0) 		AS REAL_SALE_AMT_ETC
        ,       NVL(SUM(A.REAL_SALE_AMT),0)    AS REAL_SALE_AMT_SUM
        FROM 	TB_SL_SALE_HDR A
        ,		TB_MS_STORE B
        ,		TB_SL_SALE_PAY_TEMPORARY C
        WHERE 	B.STORE_CD      = A.STORE_CD
        AND 	A.HQ_OFFICE_CD  = #{hqOfficeCd}
        AND 	A.SALE_DATE BETWEEN #{startDate} AND #{endDate}
        <if test='storeCdQuery != null and storeCdQuery != ""'>
            AND A.STORE_CD IN (${storeCdQuery})
        </if>
        AND		C.HQ_OFFICE_CD      (+) = A.HQ_OFFICE_CD
        AND		C.HQ_BRAND_CD       (+) = A.HQ_BRAND_CD
        AND		C.STORE_CD 		    (+) = A.STORE_CD
        AND		C.SALE_DATE 	    (+) = A.SALE_DATE
        AND		C.POS_NO 		    (+) = A.POS_NO
        AND		C.BILL_NO 		    (+) = A.BILL_NO
        AND		C.TEMPORARY_PAY_CD  (+) = '08'
        GROUP
        BY 		A.SALE_DATE
        ,		A.STORE_CD
        ,		B.STORE_NM
        ORDER
        BY 		A.SALE_DATE
        ,		A.STORE_CD
    </select>

    <!-- 채널별 매출 - 그리드 컬럼 조회 -->
    <!--
        TABLE    : TB_CM_NMCODE
        PARAM    : SaleByChannelVO
        COMMENTS : 그리드 컬럼 조회
    -->
    <select id="getDlvrColList" parameterType="SaleByChannelVO" resultType="DefaultMap">
        /* USE : SaleByChannelMapper.getDlvrColList */
        SELECT 	A.DLVR_NM || B.NMCODE_NM AS DLVR_NM
        ,		CASE
                    WHEN B.NMCODE_CD = '1' THEN 'Comm'
                    WHEN B.NMCODE_CD = '2' THEN 'Dlvr'
                    WHEN B.NMCODE_CD = '3' THEN 'Pack'
                END AS DLVR_FG
        ,		A.DLVR_CD
        ,		CASE
                    WHEN A.DLVR_CD IN ('3','4','5','9','12','13') AND B.NMCODE_CD = '1' THEN 'false'
                    ELSE 'true'
                END AS VISIBLE
        FROM 	(
                    SELECT 	'0' AS DLVR_CD
                    , 		'일반' AS DLVR_NM
                    FROM DUAL
                    UNION
                    SELECT 	tcn.NMCODE_CD AS DLVR_CD
                    , 		tcn.NMCODE_NM AS DLVR_NM
                    FROM 	TB_CM_NMCODE tcn
                    WHERE 	tcn.NMCODE_GRP_CD = '112'
                    AND 	tcn.NMCODE_CD IN ('1','3','4','5','9','12','13')
                ) A
        ,		(
                    SELECT 	DECODE(NMCODE_NM,'일반','내점',NMCODE_NM) AS NMCODE_NM
                    ,		NMCODE_CD
                    FROM 	TB_CM_NMCODE tcn
                    WHERE 	NMCODE_GRP_CD  = '017'
                ) B
        ORDER
        BY 		CASE A.DLVR_CD
                      WHEN '0'  THEN 1
                      WHEN '1'  THEN 2
                      WHEN '3'  THEN 3
                      WHEN '4'  THEN 4
                      WHEN '13' THEN 5
                      WHEN '5'  THEN 6
                      WHEN '12' THEN 7
                      WHEN '9'  THEN 8
                      ELSE 999 -- 그 외 값은 마지막
                END
        ,		B.NMCODE_CD
    </select>
</mapper>
