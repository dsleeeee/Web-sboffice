<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    Kiosk.xml
    다국어관리(키오스크(카테고리)/사이드/옵션)
    ======================================================
    No  ||  수정자 ||  수정일자    ||  수정내역
    ======================================================
    1       이다솜     2023.11.03     최초작성
-->

<mapper namespace="kr.co.solbipos.base.multilingual.kiosk.service.impl.KioskMapper">

    <!-- 키오스크(카테고리) 탭 리스트 조회 -->
    <!--
        TABLE    : TB_HQ_KIOSK_CLS
        PARAM    : kioskVO
        COMMENTS : 키오스크(카테고리) 탭 리스트를 조회한다.
    -->
    <select id="getKioskCategoryList" parameterType="kioskVO" resultType="DefaultMap">
         /* USE : KioskMapper.getKioskCategoryList */
         SELECT thkc.HQ_OFFICE_CD
         ,      thkc.TU_CLS_TYPE
         ,      thkg.TU_CLS_TYPE_NM
         ,      thkc.TU_CLS_CD
         ,      thkc.TU_CLS_NM
         ,      thkc.TU_PAGE
         ,      thkc.X
         ,      thkc.Y
         ,      thkc.WIDTH
         ,      thkc.HEIGHT
         ,      thkc.INDEX_NO
         ,      thkc.CLS_FG
         ,      thkc.CLS_MEMO
         ,      thkc.TU_M_CLS_FG
         ,      thkc.TU_CLS_EN_NM
         ,      thkc.TU_CLS_CN_NM
         ,      thkc.TU_CLS_JP_NM
         ,      NVL((
                SELECT  NMCODE_ITEM_2
                FROM    TB_HQ_NMCODE thn
                WHERE   thn.HQ_OFFICE_CD = thkc.HQ_OFFICE_CD
                AND     thn.NMCODE_GRP_CD = '229'
                AND     thn.NMCODE_NM = thkc.TU_CLS_TYPE
                AND     thn.NMCODE_ITEM_1 = thkc.TU_CLS_CD
                ), 'N') AS STORE_MOD_YN
         FROM   TB_HQ_KIOSK_CLS thkc
         ,      TB_HQ_KIOSK_GROUP thkg
         WHERE  thkc.HQ_OFFICE_CD = #{hqOfficeCd}
         AND    thkc.HQ_OFFICE_CD = thkg.HQ_OFFICE_CD(+)
         AND    thkc.TU_CLS_TYPE = thkg.TU_CLS_TYPE(+)
        <if test="tuClsType != null and tuClsType != ''">
         AND    thkc.TU_CLS_TYPE = #{tuClsType}
        </if>
         AND    thkc.TU_CLS_TYPE NOT IN ('00')
         ORDER
         BY     thkc.TU_CLS_TYPE, thkc.INDEX_NO
    </select>

    <!-- 키오스크(카테고리) 영문, 중문, 일문 저장 -->
    <!--
        TABLE    : TB_HQ_KIOSK_CLS
        PARAM    : kioskVO
        COMMENTS : 키오스크(카테고리) 영문, 중문, 일문을 저장한다.
    -->
    <update id="saveKioskCategory" parameterType="kioskVO">
        /* USE : KioskMapper.saveKioskCategory */
        MERGE INTO TB_HQ_KIOSK_CLS thkc
        USING DUAL
        ON (
            HQ_OFFICE_CD = #{hqOfficeCd}
        AND TU_CLS_TYPE  = #{tuClsType}
        AND TU_CLS_CD    = #{tuClsCd}
        )
        WHEN MATCHED THEN
        UPDATE
        SET
            TU_CLS_EN_NM  = #{tuClsEnNm}
        ,   TU_CLS_CN_NM  = #{tuClsCnNm}
        ,   TU_CLS_JP_NM  = #{tuClsJpNm}
        ,   MOD_DT        = #{modDt}
        ,   MOD_ID        = #{modId}
    </update>
</mapper>