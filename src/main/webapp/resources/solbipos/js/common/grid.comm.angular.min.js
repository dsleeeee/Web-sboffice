"use strict";function RootController(t,e,n,o){e.name=t,e._gridDataInit=function(){e.data=new wijmo.collections.CollectionView([])},e._inquiryMain=function(t,n,o){e._inquiry(t,n,o,!0,!0)},e._inquirySub=function(t,n,o,a){a||(a=!0),e._inquiry(t,n,o,a,!1)},e._inquiry=function(t,o,a,i,r){if(r)for(var c=angular.element("input"),l="",u=0,s=c.length;u<s;u+=1)(l=angular.element(c[u]).attr("ng-model"))&&e[l]&&(o[l]=e[l]);e.getCurr()>0?o.curr=e.getCurr():o.curr=1,n({method:"POST",url:t,params:o,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(t){var n=t.data.data.list;if(void 0===n.length||0===n.length)return e.data=new wijmo.collections.CollectionView([]),void(i&&e.s_alert(t.data.message));var o=new wijmo.collections.CollectionView(n);o.trackChanges=!0,e.data=o,t.data.data.page.curr&&(e.pagingInfo=t.data.data.page,e.pagingInfo.ctrlName=e.name,e._broadcast("drawPaging",e.pagingInfo))},function(t){e.s_alert(messages["cmm.error"])}).then(function(){"function"==typeof a&&setTimeout(function(){a()},10)})},e._addRow=function(t,n){var o=e.flex;o.collectionView||(o.itemsSource=new wijmo.collections.CollectionView);var a=o.collectionView.addNew();a.status="I",a.gChk=!0;for(var i in t)a[i]=t[i];o.collectionView.trackChanges=!0,o.collectionView.commitNew(),setTimeout(function(){o.scrollIntoView(o.rows.length-1,0),o.select(o.rows.length-1,1),o.focus(),o.startEditing(!0,o.rows.length-1,null===n?0:n,!0)},50)},e._save=function(t,o,a){o.length<=0?e.s_alert(messages["cmm.not.modify"]):(o=JSON.stringify(o),n({method:"POST",url:t,data:o,headers:{"Content-Type":"application/json; charset=utf-8"}}).then(function(t){e.s_alert(messages["cmm.saveSucc"]),e.flex.collectionView.clearChanges()},function(t){e.s_alert(messages["cmm.saveFail"])}).then(function(){null!=a&&setTimeout(function(){},10)}))},e._itemFormatter=function(t,n,a,i){if(t.cellType===wijmo.grid.CellType.ColumnHeader)e.flex.getMergedRange(t,n,a)&&(i.innerHTML="<div class='wj-header merged-custom'>"+i.innerHTML+"</div>");else if(t.cellType===wijmo.grid.CellType.TopLeft)o||$(i).css({background:"none","background-color":"#e8e8e8"});else if(t.cellType===wijmo.grid.CellType.RowHeader)t.rows[n]instanceof wijmo.grid.GroupRow?i.textContent="":isEmpty(t._rows[n]._data.rnum)?i.textContent=(n+1).toString():i.textContent=t._rows[n]._data.rnum.toString();else if(t.cellType===wijmo.grid.CellType.Cell){t.columns[a].isReadOnly&&wijmo.addClass(i,"wj-custom-readonly")}},e.$watch("flex",function(){var t=e.flex;t&&(t.beginningEdit.addHandler(function(e,n){"gChk"!==e.columns[n.col].binding&&(e.rows[n.row].dataItem.gChk?e.columns[n.col].dataType!==wijmo.DataType.Boolean&&setTimeout(function(){var t=e.getCellData(n.row,n.col,!0);null!==e.activeEditor&&""!==e.activeEditor.value&&wijmo.setSelectionRange(e.activeEditor,t.length)},0):(n.cancel=!0,t.endUpdate()))}),t.cellEditEnded.addHandler(function(t,e){}),t.rowEditEnded.addHandler(function(t,e){}))}),e.getGridCell=function(t,n){var o=e.flex.getCellBoundingRect(t,n),a=document.elementFromPoint(o.left+o.width/2,o.top+o.height/2);for(wijmo.hasClass(a,"wj-header")&&(a=null);a&&!wijmo.hasClass(a,"wj-cell");)a=a.parentElement;return a},e._makePickColumns=function(t){var n=e.flex;n&&o&&n.hostElement.addEventListener("mousedown",function(o){n.hitTest(o).cellType===wijmo.grid.CellType.TopLeft&&(e.picker||(e.picker=new wijmo.grid.ColumnPicker("#"+t),e.picker.orgColumns=e.flex.columns),e.picker.grid=e.flex,e.colPicker.show(!0,function(t){var n=t.dialogResult;n&&n.indexOf("apply")>-1&&e.picker.save()}),o.preventDefault())})}}!function(t,e){var n=angular.module("rootApp",["wj","ngSanitize"]);n.controller("rootCtrl",["$scope","$http","$compile","comboData","pagingData",function(t,e,n,o,a){t._broadcast=function(e,n){t.$broadcast("init"),t.$broadcast(e,n)},t._pagingView=function(e,n){t.setCurr(n),t.$broadcast(e)},t.$on("loadingPopupActive",function(){t._loadingTent.show(!0)}),t.$on("loadingPopupInactive",function(){t._loadingTent.hide()}),t.s_alert=function(e,n){t.s_alert_msg=e,setTimeout(function(){t._alertTent.show(!0,function(){"function"==typeof n&&setTimeout(function(){n()},10)})},100)},t.$on("drawPaging",function(e,o){var a=o.pageScale,i=10==a?9:4,r="",c={};c.ctrlName=o.ctrlName,c.curr=o.curr,c.tot=o.totCnt,c.start=0,c.end=0;var l=o.curr/a;-1===l.toString().indexOf(".")?(c.end=o.curr,c.start=c.end-i):(c.start=parseInt(l)*a+1,c.end=c.start+i),c.end>o.totalPage&&(c.end=o.totalPage),o.totCnt>a&&(r+=wijmo.format('<li class="btn_previous" data-tot={tot}><a href="javascript:;"></a></li>',c));for(var u=c.start;u<=c.end;u++)c.i=u,c.cnm=u===o.curr?"on pagenav":"pagenav",r+=wijmo.format('<li><a href="javascript:;" class="{cnm}" data-value={i} ng-click="_pagingView(\'{ctrlName}\', \'{i}\');">{i}</a></li>',c);o.totalPage>a&&(r+=wijmo.format('<li class="btn_next" data-curr={curr}><a href="javascript:;"></a></li>',c));var s=n(r)(t),d=o.ctrlName+"Pager";angular.element(document.getElementById(d)).children().remove(),angular.element(document.getElementById(d)).append(s)}),t.setCurr=function(t){a.set(t)},t.getCurr=function(){return a.get()},t.setComboData=function(t,e){o.set(t,e)},t.getComboData=function(t){return o.get(t)},t.initComboBox=function(t){t._tbx.id=t._orgAtts.id.value,t._tbx.setAttribute("ng-model",t._orgAtts["ng-model"]),t._tbx.attributes["ng-model"].value=t._orgAtts["ng-model"].value}}]),n.directive("compile",["$compile",function(t){return function(e,n,o){e.$watch(function(t){return t.$eval(o.compile)},function(o){n.html(o),t(n.contents())(e)})}}]),n.factory("myHttpInterceptor",function(t,e,n){return{request:function(t){return n.$broadcast("loadingPopupActive"),t},requestError:function(t){return console.log("from REQUEST ERROR"),n.$broadcast("loadingPopupInactive"),e.reject("Couldnot have a successfull request, Sorry :(")},response:function(t){return n.$broadcast("loadingPopupInactive"),t},responseError:function(t){return console.log("from RESPONSE ERROR"),n.$broadcast("loadingPopupInactive"),e.reject(t)}}}).factory("comboData",function(){var t=[];return t.set=function(e,n){t[e]=n},t.get=function(e){return t[e]},t}).factory("pagingData",function(){var t={set:function(e){t.value=e},get:function(){return t.value}};return t}),n.config(function(t){t.interceptors.push("myHttpInterceptor")});var o={getApp:function(){return n},getScope:function(t){var e='div[ng-controller="'+t+'"]';return angular.element(e).scope()}};t.agrid=o}("undefined"!=typeof window?window:this,angular);
