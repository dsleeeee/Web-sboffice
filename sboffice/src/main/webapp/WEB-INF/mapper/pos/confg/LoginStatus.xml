<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.solbipos.pos.confg.loginstatus.service.impl.LoginStatusMapper">

  <select id="selectLoginStatus" parameterType="loginStatusVO" resultType="DefaultMap">
    /* LoginStatusMapper.selectLoginStatus */
    <include refid="CmmSQL.PagingTemplateHeader"/>
    SELECT
           B.HQ_OFFICE_CD,
           C.HQ_OFFICE_NM,
           A.STORE_CD,
           B.STORE_NM,
           A.POS_NO,
           A.LOGIN_DATE,
           A.HW_AUTH_KEY,
           A.LOGIN_IP,
           A.LOGIN_DT,
           A.POS_VER_NO,
           B.SYS_STAT_FG,
           (SELECT NMCODE_NM FROM TB_CM_NMCODE WHERE NMCODE_GRP_CD = '009' AND NMCODE_CD = B.SYS_STAT_FG) SYS_STAT_FG_NM,
           A.LOGIN_SEQ
           <include refid="CmmSQL.PagingTemplateCount"/>
      FROM TB_MS_POS_LOGIN_LOG A,
           TB_MS_STORE B,
           TB_HQ_OFFICE C
     WHERE A.STORE_CD = B.STORE_CD
       AND B.HQ_OFFICE_CD = C.HQ_OFFICE_CD
     <if test="chkDt == false">
       <if test="startDt != null and startDt != '' and endDt != null and endDt != ''">
       AND A.LOGIN_DATE BETWEEN #{startDt} AND #{endDt} --조회(영업)일자
       </if>
     </if>
     <if test="hqOfficeCd != null and hqOfficeCd != ''">
       AND C.HQ_OFFICE_CD = #{hqOfficeCd} --본사코드
     </if>
     <if test="hqOfficeNm != null and hqOfficeNm != ''">
       AND C.HQ_OFFICE_NM = #{hqOfficeNm} --본사명
     </if>
     <if test="storeCd != null and storeCd != ''">
       AND B.STORE_CD = #{storeCd} --매장코드
     </if>
     <if test="storeNm != null and storeNm != ''">
       AND B.STORE_NM = #{storeNm}
     </if>
     <if test="sysStatFg != null and sysStatFg.name() != 'ALL'">
       AND B.SYS_STAT_FG = #{sysStatFg} --매장상태
     </if>
     ORDER BY RNUM ASC
     <include refid="CmmSQL.PagingTemplateBottom"/>
  </select>

</mapper>



