"use strict";function RootController(n,o,p,q){o.name=n;o._gridDataInit=function(){o.data=new wijmo.collections.CollectionView([])};o._inquiryMain=function(a,b,c){_inquiry(a,b,c,true,true)};o._inquirySub=function(a,b,c,d){if(!d){d=true}_inquiry(a,b,c,d,false)};function _inquiry(e,f,g,h,j){o.$broadcast('loadingPopupActive');if(j){var k=angular.element('input');var m='';for(var i=0,l=k.length;i<l;i+=1){m=angular.element(k[i]).attr('ng-model');if(m&&o[m]){f[m]=o[m]}}}if(o._getPagingInfo("curr")>0){f['curr']=o._getPagingInfo("curr")}else{f['curr']=1}if(document.getElementsByName("sessionId")[0]){f['sid']=document.getElementsByName("sessionId")[0].value}p({method:'POST',url:e,params:f,headers:{'Content-Type':'application/json; charset=utf-8'}}).then(function successCallback(a){o.$broadcast('loadingPopupInactive');if(_httpStatusCheck(a)){var b=a.data.data.list;if(b.length===undefined||b.length===0){o.data=new wijmo.collections.CollectionView([]);if(h){o._popMsg(a.data.message)}return false}var c=new wijmo.collections.CollectionView(b);c.trackChanges=true;o.data=c;if(a.data.data.page&&a.data.data.page.curr){var d=a.data.data.page;o._setPagingInfo("ctrlName",o.name);o._setPagingInfo("pageScale",d.pageScale);o._setPagingInfo("curr",d.curr);o._setPagingInfo("totCnt",d.totCnt);o._setPagingInfo("totalPage",d.totalPage);o._broadcast('drawPager')}}},function errorCallback(a){console.log("response ",a);o.$broadcast('loadingPopupInactive');o._popMsg(messages["cmm.error"]);return false}).then(function(){if(typeof g==='function'){setTimeout(function(){g()},10)}})}o._addRow=function(a,b){_gridAddRow(a,b)};function _gridAddRow(a,b){var c=o.flex;if(!c.collectionView){c.itemsSource=new wijmo.collections.CollectionView()}var d=c.collectionView.addNew();d.status="I";d.gChk=true;for(var e in a){d[e]=a[e]}c.collectionView.trackChanges=true;c.collectionView.commitNew();setTimeout(function(){c.scrollIntoView(c.rows.length-1,0);c.select(c.rows.length-1,1);c.focus();c.startEditing(true,c.rows.length-1,(b===null?0:b),true)},50)}o._save=function(a,b,c){return _gridSave(a,b,c)};function _gridSave(b,c,d){var e={};if(c.length<=0){o._popMsg(messages["cmm.not.modify"]);return false}else{o.$broadcast('loadingPopupActive',messages["cmm.saving"]);if(document.getElementsByName("sessionId")[0]){e['sid']=document.getElementsByName("sessionId")[0].value}}p({method:'POST',url:b,data:c,params:e,headers:{'Content-Type':'application/json; charset=utf-8'}}).then(function successCallback(a){o.$broadcast('loadingPopupInactive');if(_httpStatusCheck(a)){o._popMsg(messages["cmm.saveSucc"]);o.flex.collectionView.clearChanges()}},function errorCallback(a){o.$broadcast('loadingPopupInactive');o._popMsg(messages["cmm.saveFail"]);return false}).then(function(){if(typeof d==='function'){setTimeout(function(){d()},10)}})}o._httpStatusCheck=function(a){return _httpStatusCheck(a)};function _httpStatusCheck(a){if(a.data.status==="OK"){return true}else if(a.data.status==="FAIL"){o._popMsg("Ajax Fail By HTTP Request");return false}else if(a.data.status==="SESSION_EXFIRE"){o._popMsg(a.data.message,function(){location.href=a.data.url});return false}else if(a.data.status==="SERVER_ERROR"){o._popMsg(a.data.message);return false}else{var b=a.data.status+" : "+a.data.message;o._popMsg(b);return false}}o._itemFormatter=function(a,r,c,b){_itemFormatter(a,r,c,b)};function _itemFormatter(b,r,c,d){if(b.cellType===wijmo.grid.CellType.ColumnHeader){var f=o.flex.getMergedRange(b,r,c);if(f){d.innerHTML="<div class=\"wj-header merged-custom\">"+d.innerHTML+"</div>"}var g=b.grid;var h=g.columns[c];if(h.binding==="gChk"||h.format==="checkBox"||h.format==="checkBoxText"){h.allowSorting=false;var j=0;for(var i=0;i<g.rows.length;i++){if(g.getCellData(i,c)===true){j++}}if(h.format==="checkBoxText"){d.innerHTML="<input id=\""+h.binding+"\" type=\"checkbox\" class=\"wj-cell-check\" />"+"<label for=\""+h.binding+"\" class=\"wj-header-label\">"+d.innerHTML+"</label>"}else{d.innerHTML="<input type=\"checkbox\" class=\"wj-cell-check\" />"}var k=d.firstChild;k.checked=j>0;k.indeterminate=j>0&&j<g.rows.length;k.addEventListener('click',function(e){g.beginUpdate();for(var i=0;i<g.rows.length;i++){var a=g.cells.getCellElement(i,0);if(!a.children[0].disabled){g.setCellData(i,c,k.checked)}}g.endUpdate()})}}else if(b.cellType===wijmo.grid.CellType.TopLeft){if(!q){$(d).css({"background":"none","background-color":"#e8e8e8"})}}else if(b.cellType===wijmo.grid.CellType.RowHeader){if(b.rows[r]instanceof wijmo.grid.GroupRow){d.textContent=""}else{if(!isEmpty(b._rows[r]._data.rnum)){d.textContent=(b._rows[r]._data.rnum).toString()}else{d.textContent=(r+1).toString()}}}else if(b.cellType===wijmo.grid.CellType.Cell){var l=b.columns[c];if(l.isReadOnly){wijmo.addClass(d,'wj-custom-readonly')}}}o.$watch('flex',function(){var b=o.flex;if(b){b.beginningEdit.addHandler(function(s,e){if(s.columns[e.col].binding!=='gChk'){if(s.columns[e.col].dataType!==wijmo.DataType.Boolean){setTimeout(function(){var a=s.getCellData(e.row,e.col,true);if(!isEmpty(s.activeEditor)&&s.activeEditor.value!==""){wijmo.setSelectionRange(s.activeEditor,a.length)}},0)}}});b.cellEditEnded.addHandler(function(s,e){});b.rowEditEnded.addHandler(function(s,e){})}});o._makePickColumns=function(a){_makePickColumns(a)};function _makePickColumns(d){var f=o.flex;if(f&&q){f.hostElement.addEventListener('mousedown',function(e){var b=f.hitTest(e);if(b.cellType===wijmo.grid.CellType.TopLeft){if(!o.picker){o.picker=new wijmo.grid.ColumnPicker('#'+d);o.picker.orgColumns=o.flex.columns}o.picker.grid=o.flex;var c=o.colPicker;c.show(true,function(s){var a=s.dialogResult;if(a&&a.indexOf('apply')>-1){o.picker.save()}});e.preventDefault()}})}}o.$on('loadingPopupActive',function(a,b){var c="<div class=\"wj-popup-loading\"><p class=\"bk\">";if(isEmpty(b)){c+=messages["cmm.loading"]}else{c+=b}c+="</p><p class=\"mt20\"><img src=\"/resource/solbipos/css/img/loading.gif\" alt=\"\" /></p></div>";o._loadingPopup.content.innerHTML=c;o._loadingPopup.show(true)});o.$on('loadingPopupInactive',function(){o._loadingPopup.hide()});o._postJSONQuery={withPopUp:function(){return _postJSON(arguments,true,"loading")},withOutPopUp:function(){return _postJSON(arguments,false,"loading")}};o._postJSONSave={withPopUp:function(){return _postJSON(arguments,true,"saving")},withOutPopUp:function(){return _postJSON(arguments,false,"saving")}};function _postJSON(b,c,d){var e=d==="loading"?messages["cmm.loading"]:messages["cmm.saving"];var f,params,success,error,complete;switch(b.length){case 3:f=b[0];params=b[1];success=b[2];break;case 4:f=b[0];params=b[1];success=b[2];complete=b[3];break;case 5:f=b[0];params=b[1];success=b[2];error=b[3];complete=b[4];break}var g={};if(document.getElementsByName("sessionId")[0]){if(d==="loading"){params['sid']=document.getElementsByName("sessionId")[0].value}else if(d==="saving"){g['sid']=document.getElementsByName("sessionId")[0].value}}if(c){o.$broadcast('loadingPopupActive',e)}var h={method:'POST',url:f,headers:{'Content-Type':'application/json; charset=utf-8'}};if(d==="loading"){h.params=params}else if(d==="saving"){h.data=params;h.params=sParams}p(h).then(function successCallback(a){if(c){o.$broadcast('loadingPopupInactive')}if(_httpStatusCheck(a)){if(d==="saving"){o._popMsg(messages["cmm.saveSucc"])}if(typeof success==="function"){success()}}},function errorCallback(a){if(c){o.$broadcast('loadingPopupInactive')}if(d==="loading"){o._popMsg(messages["cmm.error"])}else if(d==="saving"){o._popMsg(messages["cmm.saveFail"])}if(typeof error==="function"){error()}return false}).then(function(){if(typeof complete==="function"){setTimeout(function(){complete()},10)}})}}function MenuController(i,j,k,l){k.params={};if(document.getElementsByName("sessionId").length>0){k.params.sid=document.getElementsByName("sessionId")[0].value}k._convertTreeModel=function(a,b){return _convertTreeModel(a,b)};function _convertTreeModel(e,f){var g=[];var h=function(b,c,d){if(b instanceof Array){return b.some(function(a){if(a.resrceCd===c.pResrce){a.children=a.children||[];return a.children.push(e.splice(d,1)[0])}return h(a.children,c,d)})}};while(e.length>0){e.some(function(a,b){if(a.pResrce===f){return g.push(e.splice(b,1)[0])}return h(g,a,b)})}return g}k._searchTree=function(a,b){_searchTree(a,b)};function _searchTree(c,d){l({method:'POST',url:c,params:k.params,headers:{'Content-Type':'application/json; charset=utf-8'}}).then(function successCallback(a){if(a.data.status==="OK"){if(a.data.data.length>0){var b=JSON.stringify(k._convertTreeModel(a.data.data,"000000"),null,'');k.items=JSON.parse(b)}else{k.items=[]}}},function errorCallback(a){k._popMsg("메뉴를 불러오는데 실패하였습니다.");return false}).then(function(){if(typeof d==='function'){setTimeout(function(){d()},10)}})}k._getCurrentMenu=function(){return _getCurrentMenu()};function _getCurrentMenu(){l({method:'POST',url:"/menu/currentMenu.sb",params:k.params,headers:{'Content-Type':'application/json; charset=utf-8'}}).then(function successCallback(a){if(a.data.status==="OK"){var b=a.data.data;if(b){k._setInitMenu(b.resrceCd)}else{k._setInitMenu("")}}},function errorCallback(a){k._popMsg("선택된 메뉴를 불러오는데 실패하였습니다.");return false})}k._searchTree(j);k._getCurrentMenu();k.loadedItems=function(s,e){_loadedItems(s,e)};function _loadedItems(s,e){var a;for(a=s.getFirstNode();a;a=a.nextSibling()){if(!isEmpty(a)){wijmo.addClass(a.element,a.dataItem.iconNm)}}s.collapseToLevel(0);var b=k._getInitMenu();if(b){for(a=s.getFirstNode();a;a=a.next()){if(isEmpty(a.nodes)){if(!isEmpty(a.dataItem)&&a.dataItem.resrceCd===b){s.selectedItem=a.dataItem}}}}}k.selectedItemChanged=function(s,e){_selectedItemChaged(s,e)};function _selectedItemChaged(s,e){var a,pNode=k._getPNode();if(pNode){for(a=pNode;a;a=a.parentNode){wijmo.removeClass(a.element,"on")}}for(a=s.selectedNode;a;a=a.parentNode){wijmo.addClass(a.element,"on")}k._setPNode(s.selectedNode)}k.itemClicked=function(s,e){_itemClicked(s,e)};function _itemClicked(s,e){if(!isEmpty(s.selectedNode.dataItem.url)){if(document.getElementsByName("sessionId").length>0){var a=document.getElementsByName("sessionId")[0].value;location.href=s.selectedNode.dataItem.url+"?sid="+a}else{location.href=s.selectedNode.dataItem.url}}if(k._getPNode()===s.selectedNode){s.selectedNode.isCollapsed=!s.selectedNode.isCollapsed}else{s.selectedNode.isCollapsed=false}}}!function(u,$){var v=angular.module('rootApp',['wj','ngSanitize']);v.controller('rootCtrl',['$scope','$http','$compile','$sce','comboData','pagingInfo','pNode','initMenu',function(k,l,m,n,o,p,q,r){k.$on('drawPager',function(){var a=k._getPagingInfo("pageScale");var b=a===10?9:4;var c="<li class=\"btn_previous\"><a href=\"javascript:void(0);\" ng-click=\"_pagePrev($event, '{ctrlName}', '{prev}');\"></a></li>";var d="<li><a href=\"javascript:void(0);\" class=\"{cnm}\" ng-click=\"_pageView('{ctrlName}', '{i}');\">{i}</a></li>";var e="<li class=\"btn_next\"><a href=\"javascript:void(0);\" ng-click=\"_pageNext($event, '{ctrlName}', '{next}');\"></a></li>";var f="";var g={};g.ctrlName=k._getPagingInfo("ctrlName");g.curr=k._getPagingInfo("curr");g.totCnt=k._getPagingInfo("totCnt");g.totalPage=k._getPagingInfo("totalPage");g.prev=0;g.next=0;g.start=0;g.end=0;var t=k._getPagingInfo("curr")/a;if(t.toString().indexOf(".")===-1){g.end=k._getPagingInfo("curr");g.start=g.end-b}else{g.start=(parseInt(t)*a)+1;g.end=g.start+b}if(g.end>g.totalPage){g.end=g.totalPage}if(g.curr>a){g.prev=g.start-1;f+=wijmo.format(c,g)}for(var i=g.start;i<=g.end;i++){g.i=i;g.cnm=i===g.curr?"on pagenav":"pagenav";f+=wijmo.format(d,g)}if(g.end<g.totalPage){g.next=g.end+1;f+=wijmo.format(e,g)}var h=m(f)(k);var j=g.ctrlName+'Pager';angular.element(document.getElementById(j)).children().remove();angular.element(document.getElementById(j)).append(h)});k._broadcast=function(a,b){k.$broadcast('init');k.$broadcast(a,b)};k._pageView=function(a,b){_pageView(a,b)};k._pagePrev=function(a,b,c){a.stopPropagation();_pageView(b,c)};k._pageNext=function(a,b,c){a.stopPropagation();_pageView(b,c)};function _pageView(a,b){k._setPagingInfo("curr",b);k.$broadcast(a)}k._popMsg=function(a,b){k.s_alert_msg=n.trustAsHtml(a);setTimeout(function(){k._alertPopup.show(true,function(){if(typeof b==='function'){setTimeout(function(){b()},50)}})},100)};k._popConfirm=function(a,b){k.s_confirm_msg=n.trustAsHtml(a);setTimeout(function(){k._alertConfirm.show(true,function(e){if(e.dialogResult==="wj-hide-apply"){if(typeof b==='function'){setTimeout(function(){b()},50)}}})},100)};k._initComboBox=function(s){s._tbx.id=s._orgAtts.id.value;s._tbx.setAttribute("ng-model",s._orgAtts['ng-model']);s._tbx.attributes['ng-model'].value=s._orgAtts['ng-model'].value};k._initDateBox=function(s){s.itemFormatter=function(a,b){var c=a.getDay();if(c===0){b.style.color='red'}else if(c===6){b.style.color='#1e88e5'}}};k._setPagingInfo=function(a,b){p.set(a,b)};k._getPagingInfo=function(a){return p.get(a)};k._setComboData=function(a,b){o.set(a,b)};k._getComboData=function(a){return o.get(a)};k._setInitMenu=function(a){r.set(a)};k._getInitMenu=function(){return r.get()};k._setPNode=function(a){q.set(a)};k._getPNode=function(){return q.get()}}]);v.factory('comboData',function(){var c=[];c.set=function(a,b){c[a]=b};c.get=function(a){return c[a]};return c}).factory('pagingData',function(){var b={};b.set=function(a){b.value=a};b.get=function(){return b.value};return b}).factory('pagingInfo',function(){var c=[];c.set=function(a,b){c[a]=b};c.get=function(a){return c[a]};return c}).factory('pNode',function(){var b={};b.set=function(a){b.value=a};b.get=function(){return b.value};return b}).factory('initMenu',function(){var b={};b.set=function(a){b.value=a};b.get=function(){return b.value};return b});v.config(function(a){});var w={getApp:function(){return v},getScope:function(a){var b='div[ng-controller="'+a+'"]';return angular.element(b).scope()}};u.agrid=w}("undefined"!==typeof window?window:this,angular);
