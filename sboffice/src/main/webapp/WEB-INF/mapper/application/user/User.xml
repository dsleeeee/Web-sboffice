<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.solbipos.application.persistance.user.UserMapper">
  
  <select id="selectUserCheck" parameterType="user" resultType="String" >
  <![CDATA[
  /* UserMapper.selectUserCheck */
    SELECT USER_ID 
      FROM TB_MS_EMPLOYEE
     WHERE EMP_NM = #{empNm}
       AND MP_NO = #{mpNo}
  ]]>
  </select>
  
  <select id="selectUserByNmAndId" parameterType="user" resultType="user" >
  <![CDATA[
  /* UserMapper.selectUserByNmAndId */
    SELECT ORGN_CD,
    	   EMP_NO,
    	   EMP_NM,
    	   EMP_PWD,
    	   ORGN_FG,
    	   WEB_USE_YN,
    	   USER_ID,
    	   MP_NO,
    	   EMAIL_ADDR,
    	   POST_NO,
    	   ADDR,
    	   ADDR_DTL,
    	   HIRE_FG,
    	   SMS_RECV_YN,
    	   USE_YN,
    	   REG_DT,
    	   REG_ID,
    	   MOD_DT,
    	   MOD_ID
      FROM TB_MS_EMPLOYEE
     WHERE EMP_NM = #{empNm}
       AND USER_ID = #{userId}
  ]]>
  </select>
  
  <select id="selectOtpTopOne" parameterType="otpAuth" resultType="otpAuth">
  <![CDATA[
  /* UserMapper.selectOtpTopOne */
    SELECT SEQ,
           USER_ID,
           AUTH_FG,
           AUTH_NO,
           RECV_MP_NO,
           REQ_IP,
           REQ_DATE,
           REQ_DT,
           TO_CHAR(TO_DATE(REQ_DT,'hh24miss') + #{otpLimit}/24/60,'hh24miss') AS PLUS_REQ_DT
      FROM TB_WB_OTP_AUTH_HIST
     WHERE USER_ID = #{userId}
       AND AUTH_FG = #{authFg}
       AND REQ_DATE = #{reqDate}
       AND ROWNUM = 1
     ORDER BY REQ_DT DESC
  ]]>
  </select>
  
  <insert id="insertOtpAuth" parameterType="otpAuth">
  <![CDATA[
  /* UserMapper.insertAuthOtp */
    INSERT INTO TB_WB_OTP_AUTH_HIST
    (
      SEQ,
      USER_ID,
      AUTH_FG,
      AUTH_NO,
      RECV_MP_NO,
      REQ_IP,
      REQ_DATE,
      REQ_DT
    )
    VALUES
    (
      #{seq},
      #{userId},
      #{authFg},
      #{authNo},
      #{recvMpNo},
      #{reqIp},
      #{reqDate},
      #{reqDt}
    )
  ]]>
  </insert>
  
</mapper>



















