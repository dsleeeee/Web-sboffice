<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
    SaleByChannelVO.xml
    채널별매출
    ======================================================
    No  ||  수정자 ||  수정일자    ||  수정내역
    ======================================================
    1       김유승     2025.07.25     최초작성
-->
<mapper namespace="kr.co.solbipos.sale.marketing.saleByChannel.service.impl.SaleByChannelMapper">

    <!-- 채널별매출 - 조회 -->
    <!--
        TABLE    :
        COMMENTS :
    -->
    <select id="getSaleByChannelList" parameterType="SaleByChannelVO" resultType="DefaultMap">
        /* SaleByChannelMapper.getSaleByChannelList */
        SELECT TO_CHAR(TO_DATE(A1.SALE_DATE, 'yyyymmdd'), 'yyyy-mm-dd') AS SALE_DATE
        ,		TO_CHAR(TO_DATE(A1.SALE_DATE , 'yyyymmdd'), 'DY') AS YOIL
        ,		A1.STORE_CD
        ,		B.STORE_NM
        ,		SUM(A1.REAL_SALE_CNT_COMM0) + NVL(SUM(A2.REAL_SALE_CNT_COMM0), 0) AS REAL_SALE_CNT_COMM0
        ,		SUM(A1.REAL_SALE_CNT_DLVR0) + NVL(SUM(A2.REAL_SALE_CNT_DLVR0), 0) AS REAL_SALE_CNT_DLVR0
        ,		SUM(A1.REAL_SALE_CNT_PACK0) + NVL(SUM(A2.REAL_SALE_CNT_PACK0), 0) AS REAL_SALE_CNT_PACK0
        ,		SUM(A1.REAL_SALE_CNT_COMM1) + NVL(SUM(A2.REAL_SALE_CNT_COMM1), 0) AS REAL_SALE_CNT_COMM1
        ,		SUM(A1.REAL_SALE_CNT_DLVR1) + NVL(SUM(A2.REAL_SALE_CNT_DLVR1), 0) AS REAL_SALE_CNT_DLVR1
        ,		SUM(A1.REAL_SALE_CNT_PACK1) + NVL(SUM(A2.REAL_SALE_CNT_PACK1), 0) AS REAL_SALE_CNT_PACK1
        ,		SUM(A1.REAL_SALE_CNT_DLVR3) + NVL(SUM(A2.REAL_SALE_CNT_DLVR05), 0) + SUM(A1.REAL_SALE_CNT_COMM3) + NVL(SUM(A2.REAL_SALE_CNT_COMM05), 0) AS REAL_SALE_CNT_DLVR3 --배민
        ,		SUM(A1.REAL_SALE_CNT_PACK3) + NVL(SUM(A2.REAL_SALE_CNT_PACK05), 0) AS REAL_SALE_CNT_PACK3 --배민
        ,		SUM(A1.REAL_SALE_CNT_DLVR4) + NVL(SUM(A2.REAL_SALE_CNT_DLVR04), 0) + SUM(A1.REAL_SALE_CNT_COMM4) + NVL(SUM(A2.REAL_SALE_CNT_COMM04), 0) AS REAL_SALE_CNT_DLVR4 --요기요
        ,		SUM(A1.REAL_SALE_CNT_PACK4) + NVL(SUM(A2.REAL_SALE_CNT_PACK04), 0) AS REAL_SALE_CNT_PACK4 --요기요
        ,		SUM(A1.REAL_SALE_CNT_DLVR13) + NVL(SUM(A2.REAL_SALE_CNT_DLVR15), 0) + SUM(A1.REAL_SALE_CNT_COMM13) + NVL(SUM(A2.REAL_SALE_CNT_COMM15), 0) AS REAL_SALE_CNT_DLVR13 --땡겨요
        ,		SUM(A1.REAL_SALE_CNT_PACK13) + NVL(SUM(A2.REAL_SALE_CNT_PACK15), 0) AS REAL_SALE_CNT_PACK13 --땡겨요
        ,		SUM(A1.REAL_SALE_CNT_DLVR12) + NVL(SUM(A2.REAL_SALE_CNT_DLVR13), 0) + SUM(A1.REAL_SALE_CNT_COMM12) + NVL(SUM(A2.REAL_SALE_CNT_COMM13), 0) AS REAL_SALE_CNT_DLVR12 --배달특급
        ,		SUM(A1.REAL_SALE_CNT_PACK12) + NVL(SUM(A2.REAL_SALE_CNT_PACK13), 0) AS REAL_SALE_CNT_PACK12 --배달특급
        ,		SUM(A1.REAL_SALE_CNT_DLVR9) + NVL(SUM(A2.REAL_SALE_CNT_DLVR97), 0) + SUM(A1.REAL_SALE_CNT_COMM9) + NVL(SUM(A2.REAL_SALE_CNT_COMM97), 0) AS REAL_SALE_CNT_DLVR9 --자사주문
        ,		SUM(A1.REAL_SALE_CNT_PACK9) + NVL(SUM(A2.REAL_SALE_CNT_PACK97), 0) AS REAL_SALE_CNT_PACK9 --자사주문
        ,		SUM(A1.REAL_SALE_CNT_DLVR5) + NVL(SUM(A2.REAL_SALE_CNT_DLVR08), 0) + SUM(A1.REAL_SALE_CNT_COMM5) + NVL(SUM(A2.REAL_SALE_CNT_COMM08), 0) AS REAL_SALE_CNT_DLVR5 --쿠팡이츠
        ,		SUM(A1.REAL_SALE_CNT_PACK5) + NVL(SUM(A2.REAL_SALE_CNT_PACK08), 0) AS REAL_SALE_CNT_PACK5 --쿠팡이츠
        ,		SUM(A1.REAL_SALE_CNT_DLVR99) + NVL(SUM(A2.REAL_SALE_CNT_DLVR11), 0) + SUM(A1.REAL_SALE_CNT_COMM99) + NVL(SUM(A2.REAL_SALE_CNT_COMM11), 0) AS REAL_SALE_CNT_DLVR99 --먹깨비
        ,		SUM(A1.REAL_SALE_CNT_PACK99) + NVL(SUM(A2.REAL_SALE_CNT_PACK11), 0) AS REAL_SALE_CNT_PACK99 --먹깨비
        ,		SUM(A1.REAL_SALE_CNT_DLVR98) + NVL(SUM(A2.REAL_SALE_CNT_DLVR64), 0) + SUM(A1.REAL_SALE_CNT_COMM98) + NVL(SUM(A2.REAL_SALE_CNT_COMM64), 0) AS REAL_SALE_CNT_DLVR98 --공공앱
        ,		SUM(A1.REAL_SALE_CNT_PACK98) + NVL(SUM(A2.REAL_SALE_CNT_PACK64), 0) AS REAL_SALE_CNT_PACK98 --공공앱
        ,		SUM(A1.REAL_SALE_CNT_ETC) AS REAL_SALE_CNT_ETC
        ,		SUM(A1.REAL_SALE_CNT_SUM) + NVL(SUM(A2.REAL_SALE_CNT_SUM), 0) + NVL(SUM(A2.REAL_SALE_CNT_COMM0), 0) + NVL(SUM(A2.REAL_SALE_CNT_DLVR0), 0) + NVL(SUM(A2.REAL_SALE_CNT_PACK0), 0) + NVL(SUM(A2.REAL_SALE_CNT_COMM1), 0) + NVL(SUM(A2.REAL_SALE_CNT_DLVR1), 0) + NVL(SUM(A2.REAL_SALE_CNT_PACK1), 0) AS REAL_SALE_CNT_SUM
        ,		SUM(A1.TOT_SALE_AMT_COMM0) + NVL(SUM(A2.TOT_SALE_AMT_COMM0), 0) AS TOT_SALE_AMT_COMM0
        ,		SUM(A1.TOT_SALE_AMT_DLVR0) + NVL(SUM(A2.TOT_SALE_AMT_DLVR0), 0) AS TOT_SALE_AMT_DLVR0
        ,		SUM(A1.TOT_SALE_AMT_PACK0) + NVL(SUM(A2.TOT_SALE_AMT_PACK0), 0) AS TOT_SALE_AMT_PACK0
        ,		SUM(A1.TOT_SALE_AMT_COMM1) + NVL(SUM(A2.TOT_SALE_AMT_COMM1), 0) AS TOT_SALE_AMT_COMM1
        ,		SUM(A1.TOT_SALE_AMT_DLVR1) + NVL(SUM(A2.TOT_SALE_AMT_DLVR1), 0) AS TOT_SALE_AMT_DLVR1
        ,		SUM(A1.TOT_SALE_AMT_PACK1) + NVL(SUM(A2.TOT_SALE_AMT_PACK1), 0) AS TOT_SALE_AMT_PACK1
        ,		SUM(A1.TOT_SALE_AMT_DLVR3) + NVL(SUM(A2.TOT_SALE_AMT_DLVR05), 0) + SUM(A1.TOT_SALE_AMT_COMM3) + NVL(SUM(A2.TOT_SALE_AMT_COMM05), 0) AS TOT_SALE_AMT_DLVR3 --배민
        ,		SUM(A1.TOT_SALE_AMT_PACK3) + NVL(SUM(A2.TOT_SALE_AMT_PACK05), 0) AS TOT_SALE_AMT_PACK3 --배민
        ,		SUM(A1.TOT_SALE_AMT_DLVR4) + NVL(SUM(A2.TOT_SALE_AMT_DLVR04), 0) + SUM(A1.TOT_SALE_AMT_COMM4) + NVL(SUM(A2.TOT_SALE_AMT_COMM04), 0) AS TOT_SALE_AMT_DLVR4 --요기요
        ,		SUM(A1.TOT_SALE_AMT_PACK4) + NVL(SUM(A2.TOT_SALE_AMT_PACK04), 0) AS TOT_SALE_AMT_PACK4 --요기요
        ,		SUM(A1.TOT_SALE_AMT_DLVR13) + NVL(SUM(A2.TOT_SALE_AMT_DLVR15), 0) + SUM(A1.TOT_SALE_AMT_COMM13) + NVL(SUM(A2.TOT_SALE_AMT_COMM15), 0) AS TOT_SALE_AMT_DLVR13 --땡겨요
        ,		SUM(A1.TOT_SALE_AMT_PACK13) + NVL(SUM(A2.TOT_SALE_AMT_PACK15), 0) AS TOT_SALE_AMT_PACK13 --땡겨요
        ,		SUM(A1.TOT_SALE_AMT_DLVR12) + NVL(SUM(A2.TOT_SALE_AMT_DLVR13), 0) + SUM(A1.TOT_SALE_AMT_COMM12) + NVL(SUM(A2.TOT_SALE_AMT_COMM13), 0) AS TOT_SALE_AMT_DLVR12 --배달특급
        ,		SUM(A1.TOT_SALE_AMT_PACK12) + NVL(SUM(A2.TOT_SALE_AMT_PACK13), 0) AS TOT_SALE_AMT_PACK12 --배달특급
        ,		SUM(A1.TOT_SALE_AMT_DLVR9) + NVL(SUM(A2.TOT_SALE_AMT_DLVR97), 0) + SUM(A1.TOT_SALE_AMT_COMM9) + NVL(SUM(A2.TOT_SALE_AMT_COMM97), 0) AS TOT_SALE_AMT_DLVR9 --자사주문
        ,		SUM(A1.TOT_SALE_AMT_PACK9) + NVL(SUM(A2.TOT_SALE_AMT_PACK97), 0) AS TOT_SALE_AMT_PACK9 --자사주문
        ,		SUM(A1.TOT_SALE_AMT_DLVR5) + NVL(SUM(A2.TOT_SALE_AMT_DLVR08), 0) + SUM(A1.TOT_SALE_AMT_COMM5) + NVL(SUM(A2.TOT_SALE_AMT_COMM08), 0) AS TOT_SALE_AMT_DLVR5 --쿠팡이츠
        ,		SUM(A1.TOT_SALE_AMT_PACK5) + NVL(SUM(A2.TOT_SALE_AMT_PACK08), 0) AS TOT_SALE_AMT_PACK5 --쿠팡이츠
        ,		SUM(A1.TOT_SALE_AMT_DLVR99) + NVL(SUM(A2.TOT_SALE_AMT_DLVR11), 0) + SUM(A1.TOT_SALE_AMT_COMM99) + NVL(SUM(A2.TOT_SALE_AMT_COMM11), 0) AS TOT_SALE_AMT_DLVR99 --먹깨비
        ,		SUM(A1.TOT_SALE_AMT_PACK99) + NVL(SUM(A2.TOT_SALE_AMT_PACK11), 0) AS TOT_SALE_AMT_PACK99 --먹깨비
        ,		SUM(A1.TOT_SALE_AMT_DLVR98) + NVL(SUM(A2.TOT_SALE_AMT_DLVR64), 0) + SUM(A1.TOT_SALE_AMT_COMM98) + NVL(SUM(A2.TOT_SALE_AMT_COMM64), 0) AS TOT_SALE_AMT_DLVR98 --공공앱
        ,		SUM(A1.TOT_SALE_AMT_PACK98) + NVL(SUM(A2.TOT_SALE_AMT_PACK64), 0) AS TOT_SALE_AMT_PACK98 --공공앱
        ,		SUM(A1.TOT_SALE_AMT_ETC) AS TOT_SALE_AMT_ETC
        ,		SUM(A1.TOT_SALE_AMT_SUM) + NVL(SUM(A2.TOT_SALE_AMT_SUM), 0) + NVL(SUM(A2.TOT_SALE_AMT_COMM0), 0) + NVL(SUM(A2.TOT_SALE_AMT_DLVR0), 0) + NVL(SUM(A2.TOT_SALE_AMT_PACK0), 0) + NVL(SUM(A2.TOT_SALE_AMT_COMM1), 0) + NVL(SUM(A2.TOT_SALE_AMT_DLVR1), 0) + NVL(SUM(A2.TOT_SALE_AMT_PACK1), 0) AS TOT_SALE_AMT_SUM
        ,		SUM(A1.TOT_DC_AMT_COMM0) + NVL(SUM(A2.TOT_DC_AMT_COMM0), 0) AS TOT_DC_AMT_COMM0
        ,		SUM(A1.TOT_DC_AMT_DLVR0) + NVL(SUM(A2.TOT_DC_AMT_DLVR0), 0) AS TOT_DC_AMT_DLVR0
        ,		SUM(A1.TOT_DC_AMT_PACK0) + NVL(SUM(A2.TOT_DC_AMT_PACK0), 0) AS TOT_DC_AMT_PACK0
        ,		SUM(A1.TOT_DC_AMT_COMM1) + NVL(SUM(A2.TOT_DC_AMT_COMM1), 0) AS TOT_DC_AMT_COMM1
        ,		SUM(A1.TOT_DC_AMT_DLVR1) + NVL(SUM(A2.TOT_DC_AMT_DLVR1), 0) AS TOT_DC_AMT_DLVR1
        ,		SUM(A1.TOT_DC_AMT_PACK1) + NVL(SUM(A2.TOT_DC_AMT_PACK1), 0) AS TOT_DC_AMT_PACK1
        ,		SUM(A1.TOT_DC_AMT_DLVR3) + NVL(SUM(A2.TOT_DC_AMT_DLVR05), 0) + SUM(A1.TOT_DC_AMT_COMM3) + NVL(SUM(A2.TOT_DC_AMT_COMM05), 0) AS TOT_DC_AMT_DLVR3 --배민
        ,		SUM(A1.TOT_DC_AMT_PACK3) + NVL(SUM(A2.TOT_DC_AMT_PACK05), 0) AS TOT_DC_AMT_PACK3  --배민
        ,		SUM(A1.TOT_DC_AMT_DLVR4) + NVL(SUM(A2.TOT_DC_AMT_DLVR04), 0) + SUM(A1.TOT_DC_AMT_COMM4) + NVL(SUM(A2.TOT_DC_AMT_COMM04), 0) AS TOT_DC_AMT_DLVR4 --요기요
        ,		SUM(A1.TOT_DC_AMT_PACK4) + NVL(SUM(A2.TOT_DC_AMT_PACK04), 0) AS TOT_DC_AMT_PACK4 --요기요
        ,		SUM(A1.TOT_DC_AMT_DLVR13) + NVL(SUM(A2.TOT_DC_AMT_DLVR15), 0) + SUM(A1.TOT_DC_AMT_COMM13) + NVL(SUM(A2.TOT_DC_AMT_COMM15), 0) AS TOT_DC_AMT_DLVR13 --땡겨요
        ,		SUM(A1.TOT_DC_AMT_PACK13) + NVL(SUM(A2.TOT_DC_AMT_PACK15), 0) AS TOT_DC_AMT_PACK13 --땡겨요
        ,		SUM(A1.TOT_DC_AMT_DLVR12) + NVL(SUM(A2.TOT_DC_AMT_DLVR13), 0) + SUM(A1.TOT_DC_AMT_COMM12) + NVL(SUM(A2.TOT_DC_AMT_COMM13), 0) AS TOT_DC_AMT_DLVR12 --배달특급
        ,		SUM(A1.TOT_DC_AMT_PACK12) + NVL(SUM(A2.TOT_DC_AMT_PACK13), 0) AS TOT_DC_AMT_PACK12 --배달특급
        ,		SUM(A1.TOT_DC_AMT_DLVR9) + NVL(SUM(A2.TOT_DC_AMT_DLVR97), 0) + SUM(A1.TOT_DC_AMT_COMM9) + NVL(SUM(A2.TOT_DC_AMT_COMM97), 0) AS TOT_DC_AMT_DLVR9 --자사주문
        ,		SUM(A1.TOT_DC_AMT_PACK9) + NVL(SUM(A2.TOT_DC_AMT_PACK97), 0) AS TOT_DC_AMT_PACK9 --자사주문
        ,		SUM(A1.TOT_DC_AMT_DLVR5) + NVL(SUM(A2.TOT_DC_AMT_DLVR08), 0) + SUM(A1.TOT_DC_AMT_COMM5) + NVL(SUM(A2.TOT_DC_AMT_COMM08), 0) AS TOT_DC_AMT_DLVR5 --쿠팡이츠
        ,		SUM(A1.TOT_DC_AMT_PACK5) + NVL(SUM(A2.TOT_DC_AMT_PACK08), 0) AS TOT_DC_AMT_PACK5 --쿠팡이츠
        ,		SUM(A1.TOT_DC_AMT_DLVR99) + NVL(SUM(A2.TOT_DC_AMT_DLVR11), 0) + SUM(A1.TOT_DC_AMT_COMM99) + NVL(SUM(A2.TOT_DC_AMT_COMM11), 0) AS TOT_DC_AMT_DLVR99 --먹깨비
        ,		SUM(A1.TOT_DC_AMT_PACK99) + NVL(SUM(A2.TOT_DC_AMT_PACK11), 0) AS TOT_DC_AMT_PACK99 --먹깨비
        ,		SUM(A1.TOT_DC_AMT_DLVR98) + NVL(SUM(A2.TOT_DC_AMT_DLVR64), 0) + SUM(A1.TOT_DC_AMT_COMM98) + NVL(SUM(A2.TOT_DC_AMT_COMM64), 0) AS TOT_DC_AMT_DLVR98 --공공앱
        ,		SUM(A1.TOT_DC_AMT_PACK98) + NVL(SUM(A2.TOT_DC_AMT_PACK64), 0) AS TOT_DC_AMT_PACK98 --공공앱
        ,		SUM(A1.TOT_DC_AMT_ETC) AS TOT_DC_AMT_ETC
        ,		SUM(A1.TOT_DC_AMT_SUM) + NVL(SUM(A2.TOT_DC_AMT_SUM), 0) + NVL(SUM(A2.TOT_DC_AMT_COMM0), 0) + NVL(SUM(A2.TOT_DC_AMT_DLVR0), 0) + NVL(SUM(A2.TOT_DC_AMT_PACK0), 0) + NVL(SUM(A2.TOT_DC_AMT_COMM1), 0) + NVL(SUM(A2.TOT_DC_AMT_DLVR1), 0) + NVL(SUM(A2.TOT_DC_AMT_PACK1), 0) AS TOT_DC_AMT_SUM
        ,		SUM(A1.REAL_SALE_AMT_COMM0) + NVL(SUM(A2.REAL_SALE_AMT_COMM0), 0) AS REAL_SALE_AMT_COMM0
        ,		SUM(A1.REAL_SALE_AMT_DLVR0) + NVL(SUM(A2.REAL_SALE_AMT_DLVR0), 0) AS REAL_SALE_AMT_DLVR0
        ,		SUM(A1.REAL_SALE_AMT_PACK0) + NVL(SUM(A2.REAL_SALE_AMT_PACK0), 0) AS REAL_SALE_AMT_PACK0
        ,		SUM(A1.REAL_SALE_AMT_COMM1) + NVL(SUM(A2.REAL_SALE_AMT_COMM1), 0) AS REAL_SALE_AMT_COMM1
        ,		SUM(A1.REAL_SALE_AMT_DLVR1) + NVL(SUM(A2.REAL_SALE_AMT_DLVR1), 0) AS REAL_SALE_AMT_DLVR1
        ,		SUM(A1.REAL_SALE_AMT_PACK1) + NVL(SUM(A2.REAL_SALE_AMT_PACK1), 0) AS REAL_SALE_AMT_PACK1
        ,		SUM(A1.REAL_SALE_AMT_DLVR3) + NVL(SUM(A2.REAL_SALE_AMT_DLVR05), 0) + SUM(A1.REAL_SALE_AMT_COMM3) + NVL(SUM(A2.REAL_SALE_AMT_COMM05), 0) AS REAL_SALE_AMT_DLVR3 --배민
        ,		SUM(A1.REAL_SALE_AMT_PACK3) + NVL(SUM(A2.REAL_SALE_AMT_PACK05), 0) AS REAL_SALE_AMT_PACK3 --배민
        ,		SUM(A1.REAL_SALE_AMT_DLVR4) + NVL(SUM(A2.REAL_SALE_AMT_DLVR04), 0) + SUM(A1.REAL_SALE_AMT_COMM4) + NVL(SUM(A2.REAL_SALE_AMT_COMM04), 0) AS REAL_SALE_AMT_DLVR4 --요기요
        ,		SUM(A1.REAL_SALE_AMT_PACK4) + NVL(SUM(A2.REAL_SALE_AMT_PACK04), 0) AS REAL_SALE_AMT_PACK4 --요기요
        ,		SUM(A1.REAL_SALE_AMT_DLVR13) + NVL(SUM(A2.REAL_SALE_AMT_DLVR15), 0) + SUM(A1.REAL_SALE_AMT_COMM13) + NVL(SUM(A2.REAL_SALE_AMT_COMM15), 0) AS REAL_SALE_AMT_DLVR13 --땡겨요
        ,		SUM(A1.REAL_SALE_AMT_PACK13) + NVL(SUM(A2.REAL_SALE_AMT_PACK15), 0) AS REAL_SALE_AMT_PACK13 --땡겨요
        ,		SUM(A1.REAL_SALE_AMT_DLVR12) + NVL(SUM(A2.REAL_SALE_AMT_DLVR13), 0) + SUM(A1.REAL_SALE_AMT_COMM12) + NVL(SUM(A2.REAL_SALE_AMT_COMM13), 0) AS REAL_SALE_AMT_DLVR12 --배달특급
        ,		SUM(A1.REAL_SALE_AMT_PACK12) + NVL(SUM(A2.REAL_SALE_AMT_PACK13), 0) AS REAL_SALE_AMT_PACK12 --배달특급
        ,		SUM(A1.REAL_SALE_AMT_DLVR9) + NVL(SUM(A2.REAL_SALE_AMT_DLVR97), 0) + SUM(A1.REAL_SALE_AMT_COMM9) + NVL(SUM(A2.REAL_SALE_AMT_COMM97), 0) AS REAL_SALE_AMT_DLVR9 --자사주문
        ,		SUM(A1.REAL_SALE_AMT_PACK9) + NVL(SUM(A2.REAL_SALE_AMT_PACK97), 0) AS REAL_SALE_AMT_PACK9 --자사주문
        ,		SUM(A1.REAL_SALE_AMT_DLVR5) + NVL(SUM(A2.REAL_SALE_AMT_DLVR08), 0) + SUM(A1.REAL_SALE_AMT_COMM5) + NVL(SUM(A2.REAL_SALE_AMT_COMM08), 0) AS REAL_SALE_AMT_DLVR5 --쿠팡이츠
        ,		SUM(A1.REAL_SALE_AMT_PACK5) + NVL(SUM(A2.REAL_SALE_AMT_PACK08), 0) AS REAL_SALE_AMT_PACK5 --쿠팡이츠
        ,		SUM(A1.REAL_SALE_AMT_DLVR99) + NVL(SUM(A2.REAL_SALE_AMT_DLVR11), 0) + SUM(A1.REAL_SALE_AMT_COMM99) + NVL(SUM(A2.REAL_SALE_AMT_COMM11), 0) AS REAL_SALE_AMT_DLVR99 --먹깨비
        ,		SUM(A1.REAL_SALE_AMT_PACK99) + NVL(SUM(A2.REAL_SALE_AMT_PACK11), 0) AS REAL_SALE_AMT_PACK99 --먹깨비
        ,		SUM(A1.REAL_SALE_AMT_DLVR98) + NVL(SUM(A2.REAL_SALE_AMT_DLVR64), 0) + SUM(A1.REAL_SALE_AMT_COMM98) + NVL(SUM(A2.REAL_SALE_AMT_COMM64), 0) AS REAL_SALE_AMT_DLVR98 --공공앱
        ,		SUM(A1.REAL_SALE_AMT_PACK98) + NVL(SUM(A2.REAL_SALE_AMT_PACK64), 0) AS REAL_SALE_AMT_PACK98 --공공앱
        ,		SUM(A1.REAL_SALE_AMT_ETC) AS REAL_SALE_AMT_ETC
        ,		SUM(A1.REAL_SALE_AMT_SUM) + NVL(SUM(A2.REAL_SALE_AMT_SUM), 0)  + NVL(SUM(A2.REAL_SALE_AMT_COMM0), 0)  + NVL(SUM(A2.REAL_SALE_AMT_DLVR0), 0)  + NVL(SUM(A2.REAL_SALE_AMT_PACK0), 0)  + NVL(SUM(A2.REAL_SALE_AMT_COMM1), 0)  + NVL(SUM(A2.REAL_SALE_AMT_DLVR1), 0)  + NVL(SUM(A2.REAL_SALE_AMT_PACK1), 0)  AS REAL_SALE_AMT_SUM
        FROM  (
                    SELECT A.SALE_DATE
                    ,		A.STORE_CD
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT END),0) 			    AS REAL_SALE_CNT_COMM0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			    AS REAL_SALE_CNT_DLVR0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT  END),0) 			AS REAL_SALE_CNT_COMM1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			    AS REAL_SALE_CNT_DLVR1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT  END),0) 			AS REAL_SALE_CNT_COMM3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			    AS REAL_SALE_CNT_DLVR3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT  END),0) 			AS REAL_SALE_CNT_COMM4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			    AS REAL_SALE_CNT_DLVR4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK4  --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT  END),0) 			AS REAL_SALE_CNT_COMM13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			AS REAL_SALE_CNT_DLVR13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT  END),0) 			AS REAL_SALE_CNT_COMM12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			AS REAL_SALE_CNT_DLVR12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT  END),0) 			AS REAL_SALE_CNT_COMM9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			    AS REAL_SALE_CNT_DLVR9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_CNT  END),0) 			AS REAL_SALE_CNT_COMM5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_CNT END),0) 			    AS REAL_SALE_CNT_DLVR5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_CNT END),0) 	    AS REAL_SALE_CNT_PACK5 --쿠팡이츠
                    ,       0   AS REAL_SALE_CNT_COMM99 --먹깨비
                    ,       0   AS REAL_SALE_CNT_DLVR99 --먹깨비
                    ,       0   AS REAL_SALE_CNT_PACK99 --먹깨비
                    ,       0   AS REAL_SALE_CNT_COMM98 --공공앱
                    ,       0   AS REAL_SALE_CNT_DLVR98 --공공앱
                    ,       0   AS REAL_SALE_CNT_PACK98 --공공앱
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','13','12','9','5') THEN A.REAL_SALE_CNT END),0)   AS REAL_SALE_CNT_ETC
                    ,       NVL(SUM(A.REAL_SALE_CNT),0)    AS REAL_SALE_CNT_SUM
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			    AS TOT_SALE_AMT_COMM1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			    AS TOT_SALE_AMT_COMM3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			    AS TOT_SALE_AMT_COMM4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK4  --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			AS TOT_SALE_AMT_COMM13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 	    AS TOT_SALE_AMT_PACK13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			AS TOT_SALE_AMT_COMM12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 	    AS TOT_SALE_AMT_PACK12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			    AS TOT_SALE_AMT_COMM9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_SALE_AMT  END),0) 			    AS TOT_SALE_AMT_COMM5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK5 --쿠팡이츠
                    ,       0   AS TOT_SALE_AMT_COMM99 --먹깨비
                    ,       0   AS TOT_SALE_AMT_DLVR99 --먹깨비
                    ,       0   AS TOT_SALE_AMT_PACK99 --먹깨비
                    ,       0   AS TOT_SALE_AMT_COMM98 --공공앱
                    ,       0   AS TOT_SALE_AMT_DLVR98 --공공앱
                    ,       0   AS TOT_SALE_AMT_PACK98 --공공앱
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','13','12','9','5') THEN A.TOT_SALE_AMT END),0) 	AS TOT_SALE_AMT_ETC
                    ,       NVL(SUM(A.TOT_SALE_AMT),0)    AS TOT_SALE_AMT_SUM
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_COMM0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		    AS TOT_DC_AMT_PACK0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 				AS TOT_DC_AMT_COMM1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		    AS TOT_DC_AMT_PACK1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 				AS TOT_DC_AMT_COMM3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		    AS TOT_DC_AMT_PACK3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 				AS TOT_DC_AMT_COMM4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		    AS TOT_DC_AMT_PACK4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 			    AS TOT_DC_AMT_COMM13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		AS TOT_DC_AMT_PACK13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 			    AS TOT_DC_AMT_COMM12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		AS TOT_DC_AMT_PACK12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 				AS TOT_DC_AMT_COMM9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 				AS TOT_DC_AMT_DLVR9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		    AS TOT_DC_AMT_PACK9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '1' THEN A.TOT_DC_AMT  END),0) 			    AS TOT_DC_AMT_COMM5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '2' THEN A.TOT_DC_AMT END),0) 			    AS TOT_DC_AMT_DLVR5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.TOT_DC_AMT END),0) 		    AS TOT_DC_AMT_PACK5 --쿠팡이츠
                    ,       0   AS TOT_DC_AMT_COMM99 --먹깨비
                    ,       0   AS TOT_DC_AMT_DLVR99 --먹깨비
                    ,       0   AS TOT_DC_AMT_PACK99 --먹깨비
                    ,       0   AS TOT_DC_AMT_COMM98 --공공앱
                    ,       0   AS TOT_DC_AMT_DLVR98 --공공앱
                    ,       0   AS TOT_DC_AMT_PACK98 --공공앱
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','13','12','9','5') THEN A.TOT_DC_AMT END),0)      AS TOT_DC_AMT_ETC
                    ,       NVL(SUM(A.TOT_DC_AMT),0)    AS TOT_DC_AMT_SUM
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT END),0) 			    AS REAL_SALE_AMT_COMM0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			    AS REAL_SALE_AMT_DLVR0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '0' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK0
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 			AS REAL_SALE_AMT_COMM1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			    AS REAL_SALE_AMT_DLVR1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '1' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK1
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 			AS REAL_SALE_AMT_COMM3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			    AS REAL_SALE_AMT_DLVR3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '3' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK3 --배민
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 			AS REAL_SALE_AMT_COMM4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			    AS REAL_SALE_AMT_DLVR4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '4' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK4 --요기요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 			AS REAL_SALE_AMT_COMM13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '13' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK13 --땡겨요
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 			AS REAL_SALE_AMT_COMM12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '12' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK12 --배달특급
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 			AS REAL_SALE_AMT_COMM9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			    AS REAL_SALE_AMT_DLVR9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '9' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK9 --자사주문
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '1' THEN A.REAL_SALE_AMT  END),0) 			AS REAL_SALE_AMT_COMM5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG = '2' THEN A.REAL_SALE_AMT END),0) 			    AS REAL_SALE_AMT_DLVR5 --쿠팡이츠
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG = '5' AND A.DLVR_ORDER_FG IN ('3','4') THEN A.REAL_SALE_AMT END),0) 	    AS REAL_SALE_AMT_PACK5 --쿠팡이츠
                    ,       0   AS REAL_SALE_AMT_COMM99 --먹깨비
                    ,       0   AS REAL_SALE_AMT_DLVR99 --먹깨비
                    ,       0   AS REAL_SALE_AMT_PACK99 --먹깨비
                    ,       0   AS REAL_SALE_AMT_COMM98 --공공앱
                    ,       0   AS REAL_SALE_AMT_DLVR98 --공공앱
                    ,       0   AS REAL_SALE_AMT_PACK98 --공공앱
                    ,		NVL(SUM(CASE WHEN A.DLVR_IN_FG NOT IN ('0','1','3','4','13','12','9','5') THEN A.REAL_SALE_AMT END),0) 	AS REAL_SALE_AMT_ETC
                    ,       NVL(SUM(A.REAL_SALE_AMT),0)    AS REAL_SALE_AMT_SUM
                    FROM 	TB_SL_DAILY_POS_DLVR A
                    WHERE 	1=1
                    AND 	A.HQ_OFFICE_CD = #{hqOfficeCd}
                    AND 	A.SALE_DATE BETWEEN #{startDate} AND #{endDate}
                    <if test='storeCdQuery != null and storeCdQuery != ""'>
                        AND A.STORE_CD IN (${storeCdQuery})
                    </if>
                    GROUP
                    BY 		A.SALE_DATE
                    ,		A.STORE_CD
                )   A1
        ,       (
                    SELECT A.SALE_DATE
                    ,       A.STORE_CD
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '1' THEN 1 END),0)          AS REAL_SALE_CNT_COMM0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '2' THEN 1 END),0)          AS REAL_SALE_CNT_DLVR0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0)   AS REAL_SALE_CNT_PACK0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '1' THEN 1 END),0)          AS REAL_SALE_CNT_COMM1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '2' THEN 1 END),0)          AS REAL_SALE_CNT_DLVR1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0)   AS REAL_SALE_CNT_PACK1
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '1' THEN 1 END),0) 			AS REAL_SALE_CNT_COMM05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '2' THEN 1 END),0) 			AS REAL_SALE_CNT_DLVR05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0) 	    AS REAL_SALE_CNT_PACK05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '1' THEN 1 END),0) 			AS REAL_SALE_CNT_COMM04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '2' THEN 1 END),0) 			AS REAL_SALE_CNT_DLVR04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0) 	    AS REAL_SALE_CNT_PACK04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '1' THEN 1 END),0) 			AS REAL_SALE_CNT_COMM15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '2' THEN 1 END),0) 			AS REAL_SALE_CNT_DLVR15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0) 	    AS REAL_SALE_CNT_PACK15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '1' THEN 1 END),0) 			AS REAL_SALE_CNT_COMM13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '2' THEN 1 END),0) 			AS REAL_SALE_CNT_DLVR13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0) 	    AS REAL_SALE_CNT_PACK13 --경기도공공앱(배달특급)
                    ,       0   AS REAL_SALE_CNT_COMM97 --자사주문
                    ,       0   AS REAL_SALE_CNT_DLVR97 --자사주문
                    ,       0   AS REAL_SALE_CNT_PACK97 --자사주문
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '1' THEN 1 END),0) 			AS REAL_SALE_CNT_COMM08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '2' THEN 1 END),0) 			AS REAL_SALE_CNT_DLVR08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0) 	    AS REAL_SALE_CNT_PACK08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '1' THEN 1 END),0) 			AS REAL_SALE_CNT_COMM11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '2' THEN 1 END),0) 			AS REAL_SALE_CNT_DLVR11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0) 	    AS REAL_SALE_CNT_PACK11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '1' THEN 1 END),0) 			AS REAL_SALE_CNT_COMM64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '2' THEN 1 END),0) 			AS REAL_SALE_CNT_DLVR64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG IN ('3','4') THEN 1 END),0) 	    AS REAL_SALE_CNT_PACK64 --공공앱
                    ,       NVL(SUM(1),0)   AS REAL_SALE_CNT_SUM
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0)          AS TOT_SALE_AMT_COMM0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0)          AS TOT_SALE_AMT_DLVR0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0)   AS TOT_SALE_AMT_PACK0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0)          AS TOT_SALE_AMT_COMM1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0)          AS TOT_SALE_AMT_DLVR1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0)   AS TOT_SALE_AMT_PACK1
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK13 --경기도공공앱(배달특급)
                    ,       0   AS TOT_SALE_AMT_COMM97 --자사주문
                    ,       0   AS TOT_SALE_AMT_DLVR97 --자사주문
                    ,       0   AS TOT_SALE_AMT_PACK97 --자사주문
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_COMM64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_SALE_AMT END),0) 			    AS TOT_SALE_AMT_DLVR64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_SALE_AMT END),0) 		AS TOT_SALE_AMT_PACK64 --공공앱
                    ,       NVL(SUM(B.TOT_SALE_AMT),0)   AS TOT_SALE_AMT_SUM
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0)          AS TOT_DC_AMT_COMM0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0)          AS TOT_DC_AMT_DLVR0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)   AS TOT_DC_AMT_PACK0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0)          AS TOT_DC_AMT_COMM1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0)          AS TOT_DC_AMT_DLVR1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)   AS TOT_DC_AMT_PACK1
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0)           AS TOT_DC_AMT_COMM05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0)           AS TOT_DC_AMT_DLVR05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)    AS TOT_DC_AMT_PACK05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0)           AS TOT_DC_AMT_COMM04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0)           AS TOT_DC_AMT_DLVR04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)    AS TOT_DC_AMT_PACK04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0)           AS TOT_DC_AMT_COMM15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0)           AS TOT_DC_AMT_DLVR15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)    AS TOT_DC_AMT_PACK15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_COMM13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_DLVR13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)    AS TOT_DC_AMT_PACK13 --경기도공공앱(배달특급)
                    ,       0   AS TOT_DC_AMT_COMM97 --자사주문
                    ,       0   AS TOT_DC_AMT_DLVR97 --자사주문
                    ,       0   AS TOT_DC_AMT_PACK97 --자사주문
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_COMM08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_DLVR08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)    AS TOT_DC_AMT_PACK08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_COMM11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_DLVR11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)    AS TOT_DC_AMT_PACK11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '1' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_COMM64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '2' THEN B.TOT_DC_AMT END),0) 			AS TOT_DC_AMT_DLVR64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.TOT_DC_AMT END),0)    AS TOT_DC_AMT_PACK64 --공공앱
                    ,       NVL(SUM(B.TOT_DC_AMT),0)   AS TOT_DC_AMT_SUM
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0)          AS REAL_SALE_AMT_COMM0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0)          AS REAL_SALE_AMT_DLVR0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 0 AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)   AS REAL_SALE_AMT_PACK0
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0)          AS REAL_SALE_AMT_COMM1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0)          AS REAL_SALE_AMT_DLVR1
                    ,       -1 * NVL(SUM(CASE WHEN NVL(B.DLVR_IN_FG, '0') = 1 AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)   AS REAL_SALE_AMT_PACK1
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0)           AS REAL_SALE_AMT_COMM05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0)           AS REAL_SALE_AMT_DLVR05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '05' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)    AS REAL_SALE_AMT_PACK05 --배민
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0)           AS REAL_SALE_AMT_COMM04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0)           AS REAL_SALE_AMT_DLVR04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '04' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)    AS REAL_SALE_AMT_PACK04 --요기요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0)           AS REAL_SALE_AMT_COMM15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0)           AS REAL_SALE_AMT_DLVR15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '15' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)    AS REAL_SALE_AMT_PACK15 --땡겨요
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_COMM13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR13 --경기도공공앱(배달특급)
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '13' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)    AS REAL_SALE_AMT_PACK13 --경기도공공앱(배달특급)
                    ,       0   AS REAL_SALE_AMT_COMM97 --자사주문
                    ,       0   AS REAL_SALE_AMT_DLVR97 --자사주문
                    ,       0   AS REAL_SALE_AMT_PACK97 --자사주문
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_COMM08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '08' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)    AS REAL_SALE_AMT_PACK08 --쿠팡이츠
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_COMM11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '11' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)    AS REAL_SALE_AMT_PACK11 --먹깨비
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '1' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_COMM64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG = '2' THEN B.REAL_SALE_AMT END),0) 			AS REAL_SALE_AMT_DLVR64 --공공앱
                    ,       NVL(SUM(CASE WHEN A.TEMPORARY_PAY_CD = '64' AND B.DLVR_ORDER_FG IN ('3','4') THEN B.REAL_SALE_AMT END),0)    AS REAL_SALE_AMT_PACK64 --공공앱
                    ,       NVL(SUM(B.REAL_SALE_AMT),0)   AS REAL_SALE_AMT_SUM
                    FROM   TB_SL_SALE_PAY_TEMPORARY A
                    ,       TB_SL_SALE_HDR B
                    WHERE 	1=1
                    AND 	A.HQ_OFFICE_CD = #{hqOfficeCd}
                    AND 	A.SALE_DATE BETWEEN #{startDate} AND #{endDate}
                    <if test='storeCdQuery != null and storeCdQuery != ""'>
                        AND A.STORE_CD IN (${storeCdQuery})
                    </if>
                    AND 	NVL(A.DLVR_IN_FG, '0')    IN ('0', '1')
                    AND 	A.TEMPORARY_PAY_CD  IN  ('05','04','15','13','08','11','64')
                    AND 	B.HQ_OFFICE_CD  = A.HQ_OFFICE_CD
                    AND 	B.HQ_BRAND_CD   = A.HQ_BRAND_CD
                    AND 	B.STORE_CD      = A.STORE_CD
                    AND 	B.SALE_DATE     = A.SALE_DATE
                    AND 	B.POS_NO        = A.POS_NO
                    AND 	B.BILL_NO       = A.BILL_NO
                    GROUP
                    BY 		A.SALE_DATE
                    ,		A.STORE_CD
                )   A2
        ,       TB_MS_STORE B
        WHERE 1=1
        AND   A2.SALE_DATE  (+)= A1.SALE_DATE
        AND   A2.STORE_CD   (+)= A1.STORE_CD
        AND   B.STORE_CD    = A1.STORE_CD
        GROUP
        BY 		A1.SALE_DATE
        ,       A1.STORE_CD
        ,       B.STORE_NM
        ORDER
        BY 		A1.SALE_DATE
        ,		A1.STORE_CD
    </select>

    <!-- 채널별 매출 - 그리드 컬럼 조회 -->
    <!--
        TABLE    : TB_CM_NMCODE
        PARAM    : SaleByChannelVO
        COMMENTS : 그리드 컬럼 조회
    -->
    <select id="getDlvrColList" parameterType="SaleByChannelVO" resultType="DefaultMap">
        /* USE : SaleByChannelMapper.getDlvrColList */
        SELECT 	A.DLVR_NM || B.NMCODE_NM AS DLVR_NM
        ,		CASE
                      WHEN B.NMCODE_CD = '1' THEN 'Comm'
                      WHEN B.NMCODE_CD = '2' THEN 'Dlvr'
                      WHEN B.NMCODE_CD = '3' THEN 'Pack'
                END AS DLVR_FG
        ,		A.DLVR_CD
        ,		CASE
                      WHEN A.DLVR_CD IN ('3','4','9','12','13','5','99','98') AND B.NMCODE_CD = '1' THEN 'false'
                      ELSE 'true'
                END AS VISIBLE
        FROM 	(
                    SELECT 	'0' AS DLVR_CD
                    , 		'일반' AS DLVR_NM
                    FROM DUAL
                    UNION
                    SELECT 	tcn.NMCODE_CD AS DLVR_CD
                    , 		tcn.NMCODE_NM AS DLVR_NM
                    FROM 	TB_CM_NMCODE tcn
                    WHERE 	tcn.NMCODE_GRP_CD = '112'
                    AND 	tcn.NMCODE_CD IN ('1','3','4','9','12','13','5')
                    UNION
                    SELECT 	'99' AS DLVR_CD
                    , 		'먹깨비' AS DLVR_NM
                    FROM DUAL
                    UNION
                    SELECT 	'98' AS DLVR_CD
                    , 		'공공앱' AS DLVR_NM
                    FROM DUAL
                ) A
        ,		(
                    SELECT 	DECODE(NMCODE_NM,'일반','내점',NMCODE_NM) AS NMCODE_NM
                    ,		NMCODE_CD
                    FROM 	TB_CM_NMCODE tcn
                    WHERE 	NMCODE_GRP_CD  = '017'
                ) B
        ORDER
        BY 		CASE A.DLVR_CD
                    WHEN '0'  THEN 1
                    WHEN '1'  THEN 2
                    WHEN '3'  THEN 3
                    WHEN '4'  THEN 4
                    WHEN '13' THEN 5
                    WHEN '12' THEN 6
                    WHEN '5'  THEN 7
                    WHEN '99'  THEN 8
                    WHEN '98'  THEN 9
                    WHEN '9'  THEN 10
                    ELSE 999 -- 그 외 값은 마지막
                END
        ,		B.NMCODE_CD
    </select>

</mapper>